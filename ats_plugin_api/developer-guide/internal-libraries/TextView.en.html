


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TextView &mdash; Apache Traffic Server 10.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/override.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MemSpan" href="MemSpan.en.html" />
    <link rel="prev" title="Internal libraries" href="index.en.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Apache Traffic Server
          

          
            
            <img src="../../_static/trans_logo_tm_380x69.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.en.html">Administrator’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.en.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-process/index.en.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.en.html">Contributing to Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-with-vagrant/index.en.html">Using Vagrant to Test Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging/index.en.html">Debugging and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../threads-and-events.en.html">Threads and Event Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cache-architecture/index.en.html">Cache Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging-architecture/index.en.html">Logging Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.en.html">Internal libraries</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">TextView</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#history">History</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="MemSpan.en.html">MemSpan</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html">TS.Scalar</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="buffer-writer.en.html">BufferWriter</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html">IntrusiveDList</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#design-notes">Design Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html">IntrusiveHashMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#details">Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#design-notes">Design Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="MemArena.en.html">MemArena</a></li>
<li class="toctree-l3"><a class="reference internal" href="AcidPtr.en.html">AcidPtr &amp; AcidCommitPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="Extendible.en.html">Extendible</a></li>
<li class="toctree-l3"><a class="reference internal" href="ArgParser.en.html">ArgParser</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.en.html">Plugin Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config-vars.en.html">Configuration Variable Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.en.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../continuous-integration/index.en.html">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/index.en.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../host-resolution-proposal.en.html">Host Resolution Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-session-architecture.en.html">An Overview Client Sessions and Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-architecture/index.en.html">Core Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-documents/index.en.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layout/index.en.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/index.en.html">Testing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonrpc/index.en.html">JSONRPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.en.html">Appendices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apache Traffic Server</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.en.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.en.html">Internal libraries</a> &raquo;</li>
        
      <li>TextView</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/developer-guide/internal-libraries/TextView.en.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="textview">
<h1>TextView<a class="headerlink" href="#textview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ts/TextView.h&gt;`</span><span class="cp"></span>
</pre></div>
</div>
<dl class="cpp class">
<dt id="_CPPv48TextView">
<span id="_CPPv38TextView"></span><span id="_CPPv28TextView"></span><span id="TextView"></span><em class="property">class </em><code class="sig-name descname">TextView</code><a class="headerlink" href="#_CPPv48TextView" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p>This class acts as a view in to memory allocated / owned elsewhere. It is in effect a pointer and
should be treated as such (e.g. care must be taken to avoid dangling references by knowing where the
memory really is). The purpose is to provide string manipulation that is fast, efficient, and
non-modifying, particularly when temporary “copies” are needed.</p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> is a subclass of <code class="code docutils literal notranslate"><span class="pre">std::string_view</span></code> and has all of those methods. In addition it
provides a number of ancillary methods of common string manipulation methods.</p>
<p>A <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> should be treated as an enhanced character pointer that both a location and a
size. This is when makes it possible to pass sub strings around without having to make copies or
allocation additional memory. This comes at the cost of keeping track of the actual owner of the
string memory and making sure the <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> does not outlive the memory owner, just as with
a normal pointer type. Internal for Traffic Server any place that passes a <code class="code docutils literal notranslate"><span class="pre">char</span> <span class="pre">*</span></code> and a size is an
excellent candidate for using a <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> as it is more convenient and no more risky than
the existing arguments.</p>
<p>In deciding between <code class="code docutils literal notranslate"><span class="pre">std::string_view</span></code> and <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> remember that these easily and
cheaply cross convert. In general if the string is treated as a block of data, <code class="code docutils literal notranslate"><span class="pre">std::string_view</span></code>
is better. If the contents of the string are to be examined / parsed non-uniformly then
<a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> is better. For example, if the string is used simply as a key or a hash source,
use <code class="code docutils literal notranslate"><span class="pre">std::string_view</span></code>. Or, if the string may contain substrings of interests such as key / value
pairs, then use a <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a>.</p>
<p><a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> provides a variety of methods for manipulating the view as a string. These are
provided as families of overloads differentiated by how characters are compared. There are four
flavors.</p>
<ul class="simple">
<li><p>Direct, a pointer to the target character.</p></li>
<li><p>Comparison, an explicit character value to compare.</p></li>
<li><p>Set, a set of characters (described by a <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a>) which are compared, any one of which matches.</p></li>
<li><p>Predicate, a function that takes a single character argument and returns a bool to indicate a match.</p></li>
</ul>
<p>If the latter three are inadequate the first, the direct pointer, can be used after finding the
appropriate character through some other mechanism.</p>
<p>The increment operator for <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> shrinks the view by one character from the front
which allows stepping through the view in normal way, although the string view itself should be the
loop condition, not a dereference of it.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TextView</span> <span class="n">v</span><span class="p">;</span>
<span class="kt">size_t</span> <span class="n">hash</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="n">v</span> <span class="p">;</span> <span class="o">++</span><span class="n">v</span><span class="p">)</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hash</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">+</span> <span class="o">*</span> <span class="n">v</span><span class="p">;</span>
</pre></div>
</div>
<p>Because the view acts as a container of characters, this can be done non-destructively.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TextView</span> <span class="n">v</span><span class="p">;</span>
<span class="kt">size_t</span> <span class="n">hash</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">char</span> <span class="nl">c</span> <span class="p">:</span> <span class="n">v</span><span class="p">)</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hash</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
</pre></div>
</div>
<p>Views are cheap to construct therefore making a copy to use destructively is very inexpensive.</p>
<p><a class="reference internal" href="MemSpan.en.html#_CPPv47MemSpan" title="MemSpan"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MemSpan</span></code></a> provides a <code class="code docutils literal notranslate"><span class="pre">find</span></code> method that searches for a matching value. The type of this
value can be anything that is fixed sized and supports the equality operator. The view is treated as
an array of the type and searched sequentially for a matching value. The value type is treated as
having no identity and cheap to copy, in the manner of a integral type.</p>
<div class="section" id="parsing-with-textview">
<h3>Parsing with TextView<a class="headerlink" href="#parsing-with-textview" title="Permalink to this headline">¶</a></h3>
<p>A primary use of <a class="reference internal" href="#_CPPv48TextView" title="TextView"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">TextView</span></code></a> is to do field oriented parsing. It is easy and fast to split
strings in to fields without modifying the original data. For example, assume that <em>value</em>
contains a null terminated string which is possibly several tokens separated by commas.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ctype.h&gt;</span><span class="cp"></span>
<span class="n">parse_token</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">TextView</span> <span class="n">v</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="c1">// construct assuming null terminated string.</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">TextView</span> <span class="n">token</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">extractPrefix</span><span class="p">(</span><span class="sc">&#39;,&#39;</span><span class="p">));</span>
    <span class="n">token</span><span class="p">.</span><span class="n">trim</span><span class="p">(</span><span class="o">&amp;</span><span class="n">isspace</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// process token</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <em>value</em> was <code class="docutils literal notranslate"><span class="pre">bob</span>&#160; <span class="pre">,dave,</span> <span class="pre">sam</span></code> then <em>token</em> would be successively <code class="docutils literal notranslate"><span class="pre">bob</span></code>, <code class="docutils literal notranslate"><span class="pre">dave</span></code>,
<code class="docutils literal notranslate"><span class="pre">sam</span></code>. After <cite>sam</cite> was extracted <em>value</em> would be empty and the loop would exit. <em>token</em>
can be empty in the case of adjacent delimiters or a trailing delimiter. Note that no memory
allocation at all is done because each view is a pointer in to <em>value</em> and there is no need to
put nul characters in the source string meaning no need to duplicate it to prevent permanent
changes.</p>
<p>What if the tokens were key / value pairs, of the form <cite>key=value</cite>? This is can be done as in the following example.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ctype.h&gt;</span><span class="cp"></span>
<span class="n">parse_token</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">TextView</span> <span class="n">in</span><span class="p">(</span><span class="n">source</span><span class="p">);</span> <span class="c1">// construct assuming null terminated string.</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">TextView</span> <span class="n">value</span><span class="p">(</span><span class="n">in</span><span class="p">.</span><span class="n">extractPrefix</span><span class="p">(</span><span class="sc">&#39;,&#39;</span><span class="p">));</span>
    <span class="n">TextView</span> <span class="nf">key</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">trim</span><span class="p">(</span><span class="o">&amp;</span><span class="n">isspace</span><span class="p">).</span><span class="n">splitPrefix</span><span class="p">(</span><span class="sc">&#39;=&#39;</span><span class="p">).</span><span class="n">rtrim</span><span class="p">(</span><span class="o">&amp;</span><span class="n">isspace</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// it&#39;s a key=value token with key and value set appropriately.</span>
      <span class="n">value</span><span class="p">.</span><span class="n">ltrim</span><span class="p">(</span><span class="o">&amp;</span><span class="n">isspace</span><span class="p">);</span> <span class="c1">// clip potential space after &#39;=&#39;.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// it&#39;s just a single token which is in value.</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Nested delimiters are handled by further splitting in a recursive way which, because the original
string is never modified, is straight forward.</p>
</div>
</div>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<p>The first attempt at this functionality was in the TSConfig library in the <code class="code docutils literal notranslate"><span class="pre">ts::Buffer</span></code> and
<code class="code docutils literal notranslate"><span class="pre">ts::ConstBuffer</span></code> classes. Originally intended just as raw memory views,
<code class="code docutils literal notranslate"><span class="pre">ts::ConstBuffer</span></code> in particular was repeated enhanced to provide better support for strings.
The header was eventually moved from <code class="docutils literal notranslate"><span class="pre">lib/tsconfig</span></code> to <code class="docutils literal notranslate"><span class="pre">lib/ts</span></code> and was used in
various parts of the Traffic Server core.</p>
<p>There was then a proposal to make these classes available to plugin writers as they proved handy in
the core. A suggested alternative was <a class="reference external" href="http://www.boost.org/doc/libs/1_61_0/libs/utility/doc/html/string_ref.html">Boost.StringRef</a> which provides a
similar functionality using <code class="code docutils literal notranslate"><span class="pre">std::string</span></code> as the base of the pre-allocated memory. A version
of the header was ported to Traffic Server (by stripping all the Boost support and cross includes) but in use
proved to provide little of the functionality available in <code class="code docutils literal notranslate"><span class="pre">ts::ConstBuffer</span></code>. If extensive
reworking was required in any case, it seemed better to start from scratch and build just what was
useful in the Traffic Server context.</p>
<p>The next step was the <code class="code docutils literal notranslate"><span class="pre">TextView</span></code> class which turned out reasonably well. It was then
suggested that more support for raw memory (as opposed to memory presumed to contain printable ASCII
data) would be useful. An attempt was made to do this but the differences in arguments, subtle
method differences, and return types made that infeasible. Instead <a class="reference internal" href="MemSpan.en.html#_CPPv47MemSpan" title="MemSpan"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MemSpan</span></code></a> was split off to
provide a <code class="code docutils literal notranslate"><span class="pre">void*</span></code> oriented view. String specific methods were stripped out and a few
non-character based methods added.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="MemSpan.en.html" class="btn btn-neutral float-right" title="MemSpan" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.en.html" class="btn btn-neutral float-left" title="Internal libraries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, dev@trafficserver.apache.org

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>
 


</body>
</html>