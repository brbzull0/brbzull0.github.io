<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="496px" preserveAspectRatio="none" style="width:415px;height:496px;" version="1.1" viewBox="0 0 415 496" width="415px" zoomAndPan="magnify"><defs><filter height="300%" id="fsmtqap5irkzc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="114" x2="114" y1="86.2969" y2="409.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="239.5" x2="239.5" y1="86.2969" y2="409.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="364.5" x2="364.5" y1="86.2969" y2="409.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="83" y="82.9951">Inbound</text><ellipse cx="114.5" cy="13" fill="#FEFECE" filter="url(#fsmtqap5irkzc)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M114.5,21 L114.5,48 M101.5,29 L127.5,29 M114.5,48 L101.5,63 M114.5,48 L127.5,63 " fill="none" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="83" y="421.6201">Inbound</text><ellipse cx="114.5" cy="434.9219" fill="#FEFECE" filter="url(#fsmtqap5irkzc)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M114.5,442.9219 L114.5,469.9219 M101.5,450.9219 L127.5,450.9219 M114.5,469.9219 L101.5,484.9219 M114.5,469.9219 L127.5,484.9219 " fill="none" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="208.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="217" y="54.6982">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="215.5" y="70.9951">Server</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="208.5" y="408.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="217" y="428.6201">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="215.5" y="444.917">Server</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="320.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="327.5" y="70.9951">Outbound</text><rect fill="#FEFECE" filter="url(#fsmtqap5irkzc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="320.5" y="408.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="327.5" y="428.6201">Outbound</text><polygon fill="#008000" points="125.5,113.2969,115.5,117.2969,125.5,121.2969,121.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="227.5,113.2969,237.5,117.2969,227.5,121.2969,231.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="119.5" x2="233.5" y1="117.2969" y2="117.2969"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="131.5" y="112.3638">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="160.5" y="112.3638">Handshake</text><polygon fill="#0000FF" points="227.5,142.4297,237.5,146.4297,227.5,150.4297,231.5,146.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="114.5" x2="233.5" y1="146.4297" y2="146.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="66" x="121.5" y="141.4966">initial data</text><path d="M164,159.5625 L164,199.5625 L310,199.5625 L310,169.5625 L300,159.5625 L164,159.5625 " fill="#FBFB77" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M300,159.5625 L300,169.5625 L310,169.5625 L300,159.5625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="170" y="176.6294">Examine initial data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="170" y="191.7622">select Outbound</text><polygon fill="#008000" points="250.5,225.8281,240.5,229.8281,250.5,233.8281,246.5,229.8281" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="352.5,225.8281,362.5,229.8281,352.5,233.8281,356.5,229.8281" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="244.5" x2="358.5" y1="229.8281" y2="229.8281"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="256.5" y="224.895">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="285.5" y="224.895">Handshake</text><path d="M204,242.9609 L204,282.9609 L399,282.9609 L399,252.9609 L389,242.9609 L204,242.9609 " fill="#FBFB77" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M389,242.9609 L389,252.9609 L399,252.9609 L389,242.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="242.5" y="260.0278">Additional Setup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="242.5" y="275.1606">(in some cases)</text><polygon fill="#0000FF" points="352.5,314.2266,362.5,318.2266,352.5,322.2266,356.5,318.2266" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="239.5" x2="358.5" y1="318.2266" y2="318.2266"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="66" x="246.5" y="313.2935">initial data</text><path d="M8,297.2266 L8,322.2266 L231,322.2266 L231,307.2266 L221,297.2266 L8,297.2266 " fill="#FBFB77" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M221,297.2266 L221,307.2266 L231,307.2266 L221,297.2266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="14" y="314.2935">Duplicate of data from Inbound.</text><path d="M153,336.3594 L153,376.3594 L321,376.3594 L321,346.3594 L311,336.3594 L153,336.3594 " fill="#FBFB77" filter="url(#fsmtqap5irkzc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M311,336.3594 L311,346.3594 L321,346.3594 L311,336.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="159" y="353.4263">Forward bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="159" y="368.5591">Inbound</text><path d="M218.25,360.7917 L215,364.0753 L218.25,367.2917 L218.25,365.125 L223.6667,365.125 L223.6667,362.9583 L218.25,362.9583 L218.25,360.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="228.6667" y="368.5591"/><path d="M235.0833,360.7917 L235.0833,362.9583 L229.6667,362.9583 L229.6667,365.125 L235.0833,365.125 L235.0833,367.2917 L238.3333,364.0081 L235.0833,360.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="243.3333" y="368.5591">Outbound</text><polygon fill="#A80036" points="125.5,387.625,115.5,391.625,125.5,395.625,121.5,391.625" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="352.5,387.625,362.5,391.625,352.5,395.625,356.5,391.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="119.5" x2="358.5" y1="391.625" y2="391.625"/><!--
@startuml

actor Inbound
participant "Traffic\nServer" as TS
participant Outbound

Inbound <-[#green]> TS : <font color="green">//TCP//</font> Handshake
Inbound -[#blue]> TS : <font color="blue">//initial data//</font>
note over TS : Examine initial data\nselect Outbound
TS <-[#green]> Outbound : <font color="green">//TCP//</font> Handshake
note over TS, Outbound : Additional Setup\n(in some cases)
TS -[#blue]> Outbound : <font color="blue">//initial data//</font>
note left : Duplicate of data from Inbound.
note over TS : Forward bytes\nInbound <&arrow-thick-left> <&arrow-thick-right> Outbound
Inbound <- -> Outbound

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>