<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="892.4686px" preserveAspectRatio="none" style="width:710px;height:892px;" version="1.1" viewBox="0 0 710 892" width="710.9623px" zoomAndPan="magnify"><defs><filter height="300%" id="f14axlslfuqoe8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.506276150627615"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="3.01255230125523" dy="3.01255230125523" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="55.9087" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="115.2301" x="184.8954" y="79.0795"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="184.8954" x2="300.1255" y1="98.8847" y2="98.8847"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="89.6234" x="197.6987" y="92.6323">ReadRequestHdr</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="44.4351" x="188.6611" y="111.0393">Check for</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="36.9038" x="236.1088" y="111.0393">CONNECT</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="188.6611" x2="288.8285" y1="116.9365" y2="116.9365"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="188.6611" x2="288.8285" y1="118.4427" y2="118.4427"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="100.1674" x="188.6611" y="129.0911">Find Peer for Service.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="55.9087" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="149.1213" x="113.7238" y="192.8033"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="113.7238" x2="262.8452" y1="212.6085" y2="212.6085"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="46.6946" x="164.9372" y="206.3562">Intercept</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="134.0586" x="117.4895" y="224.7632">Intercept Client Transaction.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="117.4895" x2="251.5481" y1="230.6603" y2="230.6603"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="117.4895" x2="251.5481" y1="232.1666" y2="232.1666"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="112.2176" x="117.4895" y="242.815">Initialize Bridge Context.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="92.0123" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="204.8536" x="4.5188" y="424.7699"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="4.5188" x2="209.3724" y1="444.5751" y2="444.5751"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="36.1506" x="88.8703" y="438.3227">Accept</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="36.9038" x="8.2845" y="456.7297">Initialize</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="26.3598" x="48.2008" y="456.7297">VConn</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="24.8536" x="77.5732" y="456.7297">data.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="462.6268" y2="462.6268"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="464.1331" y2="464.1331"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="131.046" x="8.2845" y="474.7815">Create internal transaction.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="480.6786" y2="480.6786"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="482.1849" y2="482.1849"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="118.9958" x="8.2845" y="492.8333">Set up Client side tunnel.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="498.7304" y2="498.7304"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="8.2845" x2="198.0753" y1="500.2367" y2="500.2367"/><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="36.9038" x="8.2845" y="510.885">CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="149.8745" x="48.2008" y="510.885">to Peer via internal transaction.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="37.857" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="67.0293" x="344.5607" y="701.9247"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="344.5607" x2="411.59" y1="721.7299" y2="721.7299"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="36.1506" x="360" y="715.4775">Tunnel</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="51.9665" x="348.3264" y="733.8845">Move data.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="66.4291" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="204.8536" x="158.159" y="817.9079"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="158.159" x2="363.0126" y1="837.7131" y2="837.7131"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="67.0293" x="227.0711" y="831.4608">Flow To Peer</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="102.4268" x="161.9247" y="849.8678">Move data from Client</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="84.3515" x="267.364" y="849.8678">TSIOBufferReader</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="34.6444" x="161.9247" y="860.3882">to Peer</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="52.7197" x="199.5816" y="860.3882">TSIOBuffer</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="3.0126" x="252.3013" y="860.3882">.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="161.9247" x2="351.7155" y1="866.2853" y2="866.2853"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="161.9247" x2="351.7155" y1="867.7916" y2="867.7916"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="67.7824" x="161.9247" y="878.44">Reenable VIOs</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="66.4291" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="200.3347" x="429.2887" y="817.9079"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="429.2887" x2="629.6234" y1="837.7131" y2="837.7131"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="72.3013" x="493.3054" y="831.4608">Flow To Client</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="97.9079" x="433.0544" y="849.8678">Move data from Peer</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="84.3515" x="533.9749" y="849.8678">TSIOBufferReader</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="39.1632" x="433.0544" y="860.3882">to Client</text><text fill="#000000" font-family="monospace" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="52.7197" x="475.2301" y="860.3882">TSIOBuffer</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="3.0126" x="527.9498" y="860.3882">.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="433.0544" x2="618.3264" y1="866.2853" y2="866.2853"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="433.0544" x2="618.3264" y1="867.7916" y2="867.7916"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="67.7824" x="433.0544" y="878.44">Reenable VIOs</text><ellipse cx="242.5105" cy="13.5565" fill="#000000" filter="url(#f14axlslfuqoe8)" rx="7.5314" ry="7.5314" style="stroke: none; stroke-width: 0.7531380753138075;"/><ellipse cx="321.59" cy="220.6695" fill="none" filter="url(#f14axlslfuqoe8)" rx="7.5314" ry="7.5314" style="stroke: #000000; stroke-width: 0.7531380753138075;"/><ellipse cx="321.9665" cy="221.046" fill="#000000" rx="4.5188" ry="4.5188" style="stroke: none; stroke-width: 0.7531380753138075;"/><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="55.9087" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="122.7615" x="547.9079" y="692.887"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="547.9079" x2="670.6695" y1="712.6922" y2="712.6922"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="52.7197" x="582.9289" y="706.4398">Shutdown</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="88.1172" x="551.6736" y="724.8469">Close Client VConn</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="551.6736" x2="659.3724" y1="730.744" y2="730.744"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="551.6736" x2="659.3724" y1="732.2503" y2="732.2503"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="107.6987" x="551.6736" y="742.8986">Close Upstream VConn</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="328.5918" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="284.6862" x="235.7322" y="306.5272"/><rect fill="#FFFFFF" height="304.2678" rx="9.4142" ry="9.4142" style="stroke: #FFFFFF; stroke-width: 0.7531380753138075;" width="280.1674" x="237.9916" y="328.5918"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="235.7322" x2="520.4184" y1="326.3324" y2="326.3324"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="125.0209" x="315.5649" y="320.08">Wait For Peer Response</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="37.857" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="120.5021" x="315.9414" y="378.2989"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="315.9414" x2="436.4435" y1="398.1041" y2="398.1041"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="99.4142" x="326.4854" y="391.8517">WaitForStatusCode</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="105.4393" x="319.7071" y="410.2587">Parse for status code.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="37.857" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="134.8117" x="264.3515" y="443.0688"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="264.3515" x2="399.1632" y1="462.874" y2="462.874"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="112.2176" x="275.6485" y="456.6216">WaitForResponseEnd</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="119.749" x="268.1172" y="475.0286">Parse for double newline.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="48.3774" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="105.4393" x="389.749" y="520.642"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="389.749" x2="495.1883" y1="540.4472" y2="540.4472"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="53.4728" x="415.7322" y="534.1948">BadStatus</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="67.0293" x="393.5146" y="552.6018">Set error data</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="90.3766" x="393.5146" y="563.1222">in Client Response.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="73.9605" rx="9.4142" ry="9.4142" style="stroke: #A80036; stroke-width: 1.1297071129707112;" width="131.7992" x="244.0167" y="507.8387"/><line style="stroke: #A80036; stroke-width: 1.1297071129707112;" x1="244.0167" x2="375.8159" y1="527.6438" y2="527.6438"/><text fill="#000000" font-family="sans-serif" font-size="10.5439" lengthAdjust="spacingAndGlyphs" textLength="56.4854" x="281.6736" y="521.3915">PeerReady</text><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="116.7364" x="247.7824" y="539.7985">Update Client Response.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="247.7824" x2="364.5188" y1="545.6956" y2="545.6956"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="247.7824" x2="364.5188" y1="547.2019" y2="547.2019"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="91.8828" x="247.7824" y="557.8503">Set up peer tunnel.</text><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="247.7824" x2="364.5188" y1="563.7474" y2="563.7474"/><line style="stroke: #A80036; stroke-width: 0.7531380753138075;" x1="247.7824" x2="364.5188" y1="565.2537" y2="565.2537"/><text fill="#000000" font-family="sans-serif" font-size="9.0377" lengthAdjust="spacingAndGlyphs" textLength="75.3138" x="247.7824" y="575.902">Start Tunneling.</text><ellipse cx="376.1925" cy="343.6546" fill="#000000" filter="url(#f14axlslfuqoe8)" rx="7.5314" ry="7.5314" style="stroke: none; stroke-width: 0.7531380753138075;"/><ellipse cx="376.1925" cy="616.2905" fill="none" filter="url(#f14axlslfuqoe8)" rx="7.5314" ry="7.5314" style="stroke: #000000; stroke-width: 0.7531380753138075;"/><ellipse cx="376.569" cy="616.6671" fill="#000000" rx="4.5188" ry="4.5188" style="stroke: none; stroke-width: 0.7531380753138075;"/><!--link *start*WaitForPeerResponse to WaitForStatusCode--><path d="M376.1925,351.201 C376.1925,357.1207 376.1925,366.0378 376.1925,374.3901 " fill="none" id="*start*WaitForPeerResponse-WaitForStatusCode" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="376.1925,378.1709,379.205,371.3926,376.1925,374.4052,373.1799,371.3926,376.1925,378.1709" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link WaitForStatusCode to WaitForResponseEnd--><path d="M363.3364,416.1817 C358.1849,423.5248 352.1975,432.0428 346.8351,439.6721 " fill="none" id="WaitForStatusCode-WaitForResponseEnd" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="344.5833,442.888,350.9455,439.0746,346.7485,439.8071,346.016,435.6102,344.5833,442.888" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link WaitForStatusCode to BadStatus--><path d="M389.3197,416.0085 C394.7799,424.052 400.918,433.7751 405.5649,443.0688 C417.5774,467.1014 427.7523,496.0445 434.3573,516.7558 " fill="none" id="WaitForStatusCode-BadStatus" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="435.5473,520.5215,436.3884,513.1518,434.4179,516.9291,430.6406,514.9587,435.5473,520.5215" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link BadStatus to *end*WaitForPeerResponse--><path d="M420.2134,569.0161 C407.6435,582.2939 392.7314,598.0646 383.882,607.411 " fill="none" id="BadStatus-*end*WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="381.1255,610.3181,387.9704,607.4603,383.7118,607.581,383.5911,603.3224,381.1255,610.3181" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link WaitForResponseEnd to PeerReady--><path d="M326.8544,480.9064 C325.0017,487.8127 322.81,495.9692 320.6335,504.088 " fill="none" id="WaitForResponseEnd-PeerReady" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="319.6318,507.8085,324.3029,502.0465,320.6108,504.1723,318.485,500.4802,319.6318,507.8085" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link PeerReady to *end*WaitForPeerResponse--><path d="M344.2218,581.7441 C353.3423,591.3843 362.3423,600.8964 368.4577,607.3658 " fill="none" id="PeerReady-*end*WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="371.2142,610.2805,368.7342,603.2898,368.6223,607.5488,364.3634,607.4369,371.2142,610.2805" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link *start to ReadRequestHdr--><path d="M242.5105,21.2159 C242.5105,32.5657 242.5105,55.8226 242.5105,75.1406 " fill="none" id="*start-ReadRequestHdr" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="242.5105,78.9439,245.523,72.1657,242.5105,75.1782,239.4979,72.1657,242.5105,78.9439" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="42.1757" x="243.2636" y="53.5232">CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="35.3975" x="288.4519" y="53.5232">Service</text><!--link ReadRequestHdr to *end--><path d="M261.6552,134.8644 C279.0678,159.5749 303.7406,194.5883 315.241,210.9013 " fill="none" id="ReadRequestHdr-*end" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="317.4854,214.087,316.0526,206.8092,315.3201,211.0061,311.1231,210.2736,317.4854,214.087" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="66.2762" x="285.4393" y="167.247">Not matched.</text><!--link ReadRequestHdr to Intercept--><path d="M229.3833,134.8644 C221.4828,151.2151 211.3983,172.077 203.1967,189.0527 " fill="none" id="ReadRequestHdr-Intercept" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="201.4795,192.6151,207.1508,187.8342,203.1247,189.2278,201.7311,185.2018,201.4795,192.6151" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link Intercept to Accept--><path d="M179.3448,248.7314 C165.7883,290.169 139.805,369.5498 122.9347,421.0946 " fill="none" id="Intercept-Accept" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="121.7372,424.7548,126.7089,419.2501,122.9087,421.176,120.9828,417.3757,121.7372,424.7548" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="114.477" x="171.7155" y="280.9709">TS_EVENT_NET_ACCEPT</text><!--link Accept to WaitForPeerResponse--><path d="M209.41,470.7113 C216.7983,470.7113 224.1866,470.7113 231.5749,470.7113 " fill="none" id="Accept-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="235.4385,470.7113,228.6603,467.6987,231.6728,470.7113,228.6603,473.7238,235.4385,470.7113" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link WaitForPeerResponse to WaitForPeerResponse--><path d="M520.5389,440.1866 C536.4678,445.9481 546.7782,456.1155 546.7782,470.7113 C546.7782,484.1623 538.0192,493.8628 524.169,499.805 " fill="none" id="WaitForPeerResponse-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="520.5389,501.236,527.9496,501.5551,524.0427,499.856,525.7417,495.9491,520.5389,501.236" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="150.6276" x="551.2971" y="474.1508">TS_EVENT_VCONN_READ_READY</text><!--link WaitForPeerResponse to Tunnel--><path d="M378.0753,635.1665 C378.0753,659.9598 378.0753,682.4259 378.0753,698.0008 " fill="none" id="WaitForPeerResponse-Tunnel" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="378.0753,701.8042,381.0879,695.0259,378.0753,698.0385,375.0628,695.0259,378.0753,701.8042" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="34.6444" x="378.8285" y="667.3307">200 OK</text><!--link *end to WaitForPeerResponse--><path d="M323.9473,231.7782 C327.231,246.2536 333.6251,274.3682 340.8929,306.3615 " fill="none" id="*end-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="323.1038,228.0728,321.6785,235.3521,323.9434,231.7437,327.5519,234.0087,323.1038,228.0728" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="95.6485" x="335.8996" y="280.9709">Peer connect failure</text><!--link Tunnel to FlowToClient--><path d="M378.5046,739.6795 C379.8151,756.0377 384.1456,779.8293 397.6569,795.3138 C405.6326,804.4569 415.3782,812.1088 425.9222,818.518 " fill="none" id="Tunnel-FlowToClient" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="429.2209,820.4611,424.9112,814.424,425.9768,818.549,421.8518,819.6146,429.2209,820.4611" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="150.6276" x="398.41" y="781.0546">TS_EVENT_VCONN_READ_READY</text><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="41.4226" x="453.0126" y="792.4517">Peer VIO</text><!--link FlowToClient to Tunnel--><path d="M551.3724,817.8778 C558.8209,802.5439 562.9858,784.6946 552.8033,771.2134 C536.3021,749.3649 461.8167,734.287 415.5891,726.846 " fill="none" id="FlowToClient-Tunnel" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="411.7556,726.236,417.9769,730.2753,415.4746,726.8272,418.9228,724.3249,411.7556,726.236" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link Tunnel to FlowToPeer--><path d="M344.395,724.9481 C292.9782,730.9732 198.723,745.328 178.4937,771.2134 C166.2778,786.8485 176.2192,802.3632 192.841,815.4603 " fill="none" id="Tunnel-FlowToPeer" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="196.0192,817.8778,192.4562,811.3721,193.0249,815.5944,188.8026,816.1631,196.0192,817.8778" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="156.6527" x="179.2469" y="781.0546">TS_EVENT_VCONN_READY_READY</text><text fill="#000000" font-family="sans-serif" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="46.6946" x="234.2259" y="792.4517">Client VIO</text><!--link FlowToPeer to Tunnel--><path d="M314.9699,817.7724 C323.8569,811.0318 332.4879,803.4703 339.6653,795.3138 C353.1841,779.9498 363.5021,758.9975 370.0167,743.3322 " fill="none" id="FlowToPeer-Tunnel" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="371.5155,739.6795,366.1546,744.806,370.0855,743.1631,371.7284,747.094,371.5155,739.6795" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><!--link Tunnel to Shutdown--><path d="M411.6954,720.7531 C446.2268,720.7531 500.8519,720.7531 543.9314,720.7531 " fill="none" id="Tunnel-Shutdown" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><polygon fill="#A80036" points="547.795,720.7531,541.0167,717.7406,544.0293,720.7531,541.0167,723.7657,547.795,720.7531" style="stroke: #A80036; stroke-width: 0.7531380753138075;"/><text fill="#000000" font-family="monospace" font-size="9.7908" lengthAdjust="spacingAndGlyphs" textLength="108.4519" x="425.523" y="715.5316">TS_EVENT_VCONN_EOS</text><!--
@startuml

scale max 720 width

ReadRequestHdr : Check for ""CONNECT""
ReadRequestHdr : =====
ReadRequestHdr : Find Peer for Service.

Intercept : Intercept Client Transaction.
Intercept : =====
Intercept : Initialize Bridge Context.

Accept : Initialize ""VConn"" data.
Accept : =====
Accept : Create internal transaction.
Accept : =====
Accept : Set up Client side tunnel.
Accept : =====
Accept : ""CONNECT"" to Peer via internal transaction.

Tunnel : Move data.

state "Flow To Peer" as FlowToPeer
FlowToPeer : Move data from Client ""TSIOBufferReader""\nto Peer ""TSIOBuffer"".
FlowToPeer : =====
FlowToPeer : Reenable VIOs

state "Flow To Client" as FlowToClient
FlowToClient : Move data from Peer ""TSIOBufferReader""\nto Client ""TSIOBuffer"".
FlowToClient : =====
FlowToClient : Reenable VIOs

state "Wait For Peer Response" as WaitForPeerResponse {
  WaitForStatusCode : Parse for status code.

  WaitForResponseEnd : Parse for double newline.

  BadStatus : Set error data\nin Client Response.

  PeerReady : Update Client Response.
  PeerReady : =====
  PeerReady : Set up peer tunnel.
  PeerReady : =====
  PeerReady : Start Tunneling.

  [*] - -> WaitForStatusCode
  WaitForStatusCode - -> WaitForResponseEnd
  WaitForStatusCode - -> BadStatus
  BadStatus - -> [*]
  WaitForResponseEnd - -> PeerReady
  PeerReady - -> [*]
}

[*] - -> ReadRequestHdr : ""CONNECT"" Service
ReadRequestHdr - -> [*] : Not matched.
ReadRequestHdr - -> Intercept
Intercept - -> Accept : ""TS_EVENT_NET_ACCEPT""
Accept -r-> WaitForPeerResponse
WaitForPeerResponse - -> WaitForPeerResponse : ""TS_EVENT_VCONN_READ_READY""
WaitForPeerResponse - -> Tunnel : 200 OK
WaitForPeerResponse -u-> [*] : Peer connect failure

Tunnel - -> FlowToClient : ""TS_EVENT_VCONN_READ_READY""\nPeer VIO
FlowToClient - -> Tunnel
Tunnel - -> FlowToPeer : ""TS_EVENT_VCONN_READY_READY""\nClient VIO
FlowToPeer - -> Tunnel

Tunnel -right-> Shutdown : ""TS_EVENT_VCONN_EOS""

Shutdown : Close Client VConn
Shutdown : =====
Shutdown : Close Upstream VConn

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>