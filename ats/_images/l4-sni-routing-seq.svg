<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="555px" preserveAspectRatio="none" style="width:546px;height:555px;" version="1.1" viewBox="0 0 546 555" width="546px" zoomAndPan="magnify"><defs><filter height="300%" id="f13e3933oezw4z" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="56" x2="56" y1="86.2969" y2="467.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="262.5" x2="262.5" y1="86.2969" y2="467.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="468.5" x2="468.5" y1="86.2969" y2="467.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="25" y="82.9951">Inbound</text><ellipse cx="56.5" cy="13" fill="#FEFECE" filter="url(#f13e3933oezw4z)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M56.5,21 L56.5,48 M43.5,29 L69.5,29 M56.5,48 L43.5,63 M56.5,48 L69.5,63 " fill="none" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="25" y="479.8857">Inbound</text><ellipse cx="56.5" cy="493.1875" fill="#FEFECE" filter="url(#f13e3933oezw4z)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M56.5,501.1875 L56.5,528.1875 M43.5,509.1875 L69.5,509.1875 M56.5,528.1875 L43.5,543.1875 M56.5,528.1875 L69.5,543.1875 " fill="none" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f13e3933oezw4z)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="231.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="240" y="54.6982">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="238.5" y="70.9951">Server</text><rect fill="#FEFECE" filter="url(#f13e3933oezw4z)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="231.5" y="466.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="240" y="486.8857">Traffic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="238.5" y="503.1826">Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="396.5" y="82.9951">app-server-56:4443</text><ellipse cx="468.5" cy="54" fill="#FEFECE" filter="url(#f13e3933oezw4z)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="456.5" x2="480.5" y1="68" y2="68"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="396.5" y="479.8857">app-server-56:4443</text><ellipse cx="468.5" cy="499.1875" fill="#FEFECE" filter="url(#f13e3933oezw4z)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="456.5" x2="480.5" y1="513.1875" y2="513.1875"/><polygon fill="#008000" points="67.5,113.2969,57.5,117.2969,67.5,121.2969,63.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="250.5,113.2969,260.5,117.2969,250.5,121.2969,254.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="61.5" x2="256.5" y1="117.2969" y2="117.2969"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="73.5" y="112.3638">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="102.5" y="112.3638">Handshake</text><polygon fill="#0000FF" points="250.5,157.4297,260.5,161.4297,250.5,165.4297,254.5,161.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="56.5" x2="256.5" y1="161.4297" y2="161.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="23" x="63.5" y="141.4966">TLS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="90.5" y="141.4966">Client HELLO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="63.5" y="156.6294">SNI=service-2.example.com</text><path d="M190,174.6953 L190,214.6953 L330,214.6953 L330,184.6953 L320,174.6953 L190,174.6953 " fill="#FBFB77" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M320,174.6953 L320,184.6953 L330,184.6953 L320,174.6953 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="196" y="191.7622">Examine SNI value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="196" y="206.895">Select Outbound</text><polygon fill="#008000" points="273.5,240.9609,263.5,244.9609,273.5,248.9609,269.5,244.9609" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="456.5,240.9609,466.5,244.9609,456.5,248.9609,460.5,244.9609" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="267.5" x2="462.5" y1="244.9609" y2="244.9609"/><text fill="#008000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="279.5" y="240.0278">TCP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="308.5" y="240.0278">Handshake</text><polygon fill="#0000FF" points="456.5,285.0938,466.5,289.0938,456.5,293.0938,460.5,289.0938" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="262.5" x2="462.5" y1="289.0938" y2="289.0938"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="23" x="269.5" y="269.1606">TLS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="296.5" y="269.1606">Client HELLO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="269.5" y="284.2935">SNI=service-2.example.com</text><path d="M55,260.6602 L55,285.6602 L253,285.6602 L253,270.6602 L243,260.6602 L55,260.6602 " fill="#FBFB77" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M243,260.6602 L243,270.6602 L253,270.6602 L243,260.6602 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="61" y="277.7271">Duplicate of Inbound HELLO</text><path d="M176,302.3594 L176,342.3594 L344,342.3594 L344,312.3594 L334,302.3594 L176,302.3594 " fill="#FBFB77" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M334,302.3594 L334,312.3594 L344,312.3594 L334,302.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="182" y="319.4263">Forward bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="182" y="334.5591">Inbound</text><path d="M241.25,326.7917 L238,330.0753 L241.25,333.2917 L241.25,331.125 L246.6667,331.125 L246.6667,328.9583 L241.25,328.9583 L241.25,326.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="251.6667" y="334.5591"/><path d="M258.0833,326.7917 L258.0833,328.9583 L252.6667,328.9583 L252.6667,331.125 L258.0833,331.125 L258.0833,333.2917 L261.3333,330.0081 L258.0833,326.7917 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="266.3333" y="334.5591">Outbound</text><path d="M8,356.625 L8,381.625 L518,381.625 L518,366.625 L508,356.625 L8,356.625 " fill="#FBFB77" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M508,356.625 L508,366.625 L518,366.625 L508,356.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="207.25" y="373.6919">TLS negotiation</text><polygon fill="#0000FF" points="67.5,392.7578,57.5,396.7578,67.5,400.7578,63.5,396.7578" style="stroke: #0000FF; stroke-width: 1.0;"/><polygon fill="#0000FF" points="456.5,392.7578,466.5,396.7578,456.5,400.7578,460.5,396.7578" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="61.5" x2="462.5" y1="396.7578" y2="396.7578"/><path d="M8,409.7578 L8,434.7578 L518,434.7578 L518,419.7578 L508,409.7578 L8,409.7578 " fill="#FBFB77" filter="url(#f13e3933oezw4z)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M508,409.7578 L508,419.7578 L518,419.7578 L508,409.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="216.25" y="426.8247">Transactions</text><polygon fill="#000000" points="67.5,445.8906,57.5,449.8906,67.5,453.8906,63.5,449.8906" style="stroke: #000000; stroke-width: 1.0;"/><polygon fill="#000000" points="456.5,445.8906,466.5,449.8906,456.5,453.8906,460.5,449.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="61.5" x2="462.5" y1="449.8906" y2="449.8906"/><!--
@startuml

actor Inbound
participant "Traffic\nServer" as TS
entity "app-server-56:4443" as Outbound

Inbound <-[#green]> TS : <font color="green">//TCP//</font> Handshake
Inbound -[#blue]> TS : <font color="blue">//TLS//</font> Client HELLO\nSNI=service-2.example.com
note over TS : Examine SNI value\nSelect Outbound
TS <-[#green]> Outbound : <font color="green">//TCP//</font> Handshake
TS -[#blue]> Outbound : <font color="blue">//TLS//</font> Client HELLO\nSNI=service-2.example.com
note left : Duplicate of Inbound HELLO
note over TS : Forward bytes\nInbound <&arrow-thick-left> <&arrow-thick-right> Outbound
note over Inbound, Outbound : <font color="blue">TLS negotiation</font>
Inbound <-[#blue]-> Outbound
note over Inbound, Outbound : Transactions
Inbound <-[#black]-> Outbound

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>