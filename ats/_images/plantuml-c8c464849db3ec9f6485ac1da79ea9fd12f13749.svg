<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="507px" preserveAspectRatio="none" style="width:509px;height:507px;" version="1.1" viewBox="0 0 509 507" width="509px" zoomAndPan="magnify"><defs><filter height="300%" id="fssr3zpbi2jxv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="271" x="120" y="22.9951">AcidPtr Reader/Reader Contention</text><rect fill="#DDDDDD" height="461.9219" style="stroke: #A80036; stroke-width: 1.0;" width="76" x="103" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="106" y="46.3638">MemLock</text><rect fill="#008000" filter="url(#fssr3zpbi2jxv)" height="127.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="136" y="176.7266"/><rect fill="#FF0000" filter="url(#fssr3zpbi2jxv)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="136" y="333.5234"/><rect fill="#FFFFFF" filter="url(#fssr3zpbi2jxv)" height="145.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="379" y="255.125"/><rect fill="#FFFFFF" filter="url(#fssr3zpbi2jxv)" height="38.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="461.5" y="362.6563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="141" x2="141" y1="116.5938" y2="409.9219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="218" x2="218" y1="116.5938" y2="409.9219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="384" x2="384" y1="116.5938" y2="409.9219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="466" x2="466" y1="116.5938" y2="409.9219"/><rect fill="#FEFECE" filter="url(#fssr3zpbi2jxv)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="107" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="114" y="101.292">Access</text><rect fill="#FEFECE" filter="url(#fssr3zpbi2jxv)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="107" y="408.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="114" y="428.917">Access</text><rect fill="#FEFECE" filter="url(#fssr3zpbi2jxv)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="185" y="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="192" y="101.292">AcidPtr</text><rect fill="#FEFECE" filter="url(#fssr3zpbi2jxv)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="185" y="408.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="192" y="428.917">AcidPtr</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="348" y="113.292">Reader_A</text><ellipse cx="384" cy="43.2969" fill="#008000" filter="url(#fssr3zpbi2jxv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M384,51.2969 L384,78.2969 M371,59.2969 L397,59.2969 M384,78.2969 L371,93.2969 M384,78.2969 L397,93.2969 " fill="none" filter="url(#fssr3zpbi2jxv)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="348" y="421.917">Reader_A</text><ellipse cx="384" cy="435.2188" fill="#008000" filter="url(#fssr3zpbi2jxv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M384,443.2188 L384,470.2188 M371,451.2188 L397,451.2188 M384,470.2188 L371,485.2188 M384,470.2188 L397,485.2188 " fill="none" filter="url(#fssr3zpbi2jxv)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="430" y="113.292">Reader_B</text><ellipse cx="466.5" cy="43.2969" fill="#FF0000" filter="url(#fssr3zpbi2jxv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M466.5,51.2969 L466.5,78.2969 M453.5,59.2969 L479.5,59.2969 M466.5,78.2969 L453.5,93.2969 M466.5,78.2969 L479.5,93.2969 " fill="none" filter="url(#fssr3zpbi2jxv)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="430" y="421.917">Reader_B</text><ellipse cx="466.5" cy="435.2188" fill="#FF0000" filter="url(#fssr3zpbi2jxv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M466.5,443.2188 L466.5,470.2188 M453.5,451.2188 L479.5,451.2188 M466.5,470.2188 L453.5,485.2188 M466.5,470.2188 L479.5,485.2188 " fill="none" filter="url(#fssr3zpbi2jxv)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#008000" filter="url(#fssr3zpbi2jxv)" height="127.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="136" y="176.7266"/><rect fill="#FF0000" filter="url(#fssr3zpbi2jxv)" height="58.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="136" y="333.5234"/><rect fill="#FFFFFF" filter="url(#fssr3zpbi2jxv)" height="145.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="379" y="255.125"/><rect fill="#FFFFFF" filter="url(#fssr3zpbi2jxv)" height="38.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="461.5" y="362.6563"/><polygon fill="#008000" points="229,143.5938,219,147.5938,229,151.5938,225,147.5938" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="223" x2="383" y1="147.5938" y2="147.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="235" y="142.6606">getPtr()</text><polygon fill="#008000" points="206,172.7266,216,176.7266,206,180.7266,210,176.7266" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="146" x2="212" y1="176.7266" y2="176.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="153" y="171.7935">lock</text><polygon fill="#A80036" points="229,201.8594,219,205.8594,229,209.8594,225,205.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223" x2="465.5" y1="205.8594" y2="205.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="235" y="200.9263">getPtr()</text><polygon fill="#008000" points="367,251.125,377,255.125,367,259.125,371,255.125" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="218" x2="373" y1="255.125" y2="255.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="225" y="250.1919">copy const shared_ptr</text><path d="M8,218.9922 L8,273.9922 L209,273.9922 L209,228.9922 L199,218.9922 L8,218.9922 " fill="#FBFB77" filter="url(#fssr3zpbi2jxv)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M199,218.9922 L199,228.9922 L209,228.9922 L199,218.9922 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="14" y="236.0591">Contention limited to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="14" y="251.1919">duration of shared_ptr copy.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="14" y="266.3247">(internally defined)</text><polygon fill="#008000" points="152,300.3906,142,304.3906,152,308.3906,148,304.3906" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="146" x2="217" y1="304.3906" y2="304.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="158" y="299.4575">unlock</text><polygon fill="#A80036" points="206,329.5234,216,333.5234,206,337.5234,210,333.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="146" x2="212" y1="333.5234" y2="333.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="153" y="328.5903">lock</text><polygon fill="#A80036" points="449.5,358.6563,459.5,362.6563,449.5,366.6563,453.5,362.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="218" x2="455.5" y1="362.6563" y2="362.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="225" y="357.7231">copy const shared_ptr</text><polygon fill="#A80036" points="152,387.7891,142,391.7891,152,395.7891,148,391.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="146" x2="217" y1="391.7891" y2="391.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="158" y="386.856">unlock</text><!--
@startuml
title AcidPtr Reader/Reader Contention
box "MemLock"
participant "Access" as AccessMutex
end box
participant AcidPtr
actor Reader_A #green
actor Reader_B #red
Reader_A -[#green]> AcidPtr: getPtr()
AcidPtr <[#green]- AccessMutex: lock
activate AccessMutex #green
Reader_B -> AcidPtr: getPtr()
AcidPtr -[#green]> Reader_A: copy const shared_ptr
activate Reader_A
note left
  Contention limited to
  duration of shared_ptr copy.
  (internally defined)
end note
AcidPtr -[#green]> AccessMutex: unlock
deactivate AccessMutex
AcidPtr <- AccessMutex: lock
activate AccessMutex #red
AcidPtr -> Reader_B: copy const shared_ptr
activate Reader_B
AcidPtr -> AccessMutex: unlock
deactivate AccessMutex

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>