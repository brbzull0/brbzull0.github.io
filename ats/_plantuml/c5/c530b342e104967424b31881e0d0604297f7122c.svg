<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="657px" preserveAspectRatio="none" style="width:628px;height:657px;" version="1.1" viewBox="0 0 628 657" width="628px" zoomAndPan="magnify"><defs><filter height="300%" id="fky13cbuczy0s" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDFFDD" height="642.5859" style="stroke: #A80036; stroke-width: 1.0;" width="430.3333" x="4" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="164.6667" y="16.0669">Client Network</text><rect fill="#DDDDFF" height="642.5859" style="stroke: #A80036; stroke-width: 1.0;" width="181.5" x="436.3333" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="456.5833" y="16.0669">Corporate Network</text><rect fill="#FFFFFF" filter="url(#fky13cbuczy0s)" height="413.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="99.5" y="137.4297"/><rect fill="#FFFFFF" filter="url(#fky13cbuczy0s)" height="326.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="388.8333" y="224.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="30" x2="30" y1="106.4297" y2="560.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="104" x2="104" y1="106.4297" y2="560.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="268.5" x2="268.5" y1="106.4297" y2="560.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="393.3333" x2="393.3333" y1="106.4297" y2="560.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="480.3333" x2="480.3333" y1="106.4297" y2="560.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="585.8333" x2="585.8333" y1="106.4297" y2="560.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="103.1279">Client</text><ellipse cx="30.5" cy="33.1328" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,41.1328 L30.5,68.1328 M17.5,49.1328 L43.5,49.1328 M30.5,68.1328 L17.5,83.1328 M30.5,68.1328 L43.5,83.1328 " fill="none" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="572.2842">Client</text><ellipse cx="30.5" cy="585.5859" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,593.5859 L30.5,620.5859 M17.5,601.5859 L43.5,601.5859 M30.5,620.5859 L17.5,635.5859 M30.5,620.5859 L43.5,635.5859 " fill="none" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="63" y="86.8311">User Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="78.5" y="103.1279">VConn</text><ellipse cx="104.5" cy="57.8359" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="92.5" x2="116.5" y1="71.8359" y2="71.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="63" y="572.2842">User Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="78.5" y="588.5811">VConn</text><ellipse cx="104.5" cy="607.8828" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="92.5" x2="116.5" y1="621.8828" y2="621.8828"/><rect fill="#FEFECE" filter="url(#fky13cbuczy0s)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="218.5" y="71.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="225.5" y="91.1279">Ingress ATS</text><rect fill="#FEFECE" filter="url(#fky13cbuczy0s)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="218.5" y="559.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="225.5" y="579.2842">Ingress ATS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="357.3333" y="86.8311">Upstream</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="367.8333" y="103.1279">VConn</text><ellipse cx="393.8333" cy="57.8359" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="381.8333" x2="405.8333" y1="71.8359" y2="71.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="357.3333" y="572.2842">Upstream</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="367.8333" y="588.5811">VConn</text><ellipse cx="393.8333" cy="607.8828" fill="#FEFECE" filter="url(#fky13cbuczy0s)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="381.8333" x2="405.8333" y1="621.8828" y2="621.8828"/><rect fill="#FEFECE" filter="url(#fky13cbuczy0s)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="440.3333" y="71.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="447.3333" y="91.1279">Peer ATS</text><rect fill="#FEFECE" filter="url(#fky13cbuczy0s)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="440.3333" y="559.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="447.3333" y="579.2842">Peer ATS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="557.8333" y="103.1279">Service</text><path d="M567.8333,54.1328 C567.8333,44.1328 585.8333,44.1328 585.8333,44.1328 C585.8333,44.1328 603.8333,44.1328 603.8333,54.1328 L603.8333,80.1328 C603.8333,90.1328 585.8333,90.1328 585.8333,90.1328 C585.8333,90.1328 567.8333,90.1328 567.8333,80.1328 L567.8333,54.1328 " fill="#FEFECE" filter="url(#fky13cbuczy0s)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M567.8333,54.1328 C567.8333,64.1328 585.8333,64.1328 585.8333,64.1328 C585.8333,64.1328 603.8333,64.1328 603.8333,54.1328 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="557.8333" y="572.2842">Service</text><path d="M567.8333,585.5859 C567.8333,575.5859 585.8333,575.5859 585.8333,575.5859 C585.8333,575.5859 603.8333,575.5859 603.8333,585.5859 L603.8333,611.5859 C603.8333,621.5859 585.8333,621.5859 585.8333,621.5859 C585.8333,621.5859 567.8333,621.5859 567.8333,611.5859 L567.8333,585.5859 " fill="#FEFECE" filter="url(#fky13cbuczy0s)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M567.8333,585.5859 C567.8333,595.5859 585.8333,595.5859 585.8333,595.5859 C585.8333,595.5859 603.8333,595.5859 603.8333,585.5859 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fky13cbuczy0s)" height="413.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="99.5" y="137.4297"/><rect fill="#FFFFFF" filter="url(#fky13cbuczy0s)" height="326.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="388.8333" y="224.8281"/><polygon fill="#A80036" points="256.5,133.4297,266.5,137.4297,256.5,141.4297,260.5,137.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30.5" x2="262.5" y1="137.4297" y2="137.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="37.5" y="132.4966">TCP or TLS connect</text><polygon fill="#A80036" points="256.5,162.5625,266.5,166.5625,256.5,170.5625,260.5,166.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30.5" x2="262.5" y1="166.5625" y2="166.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="37.5" y="161.6294">HTTP CONNECT</text><polygon fill="#A80036" points="120.5,191.6953,110.5,195.6953,120.5,199.6953,116.5,195.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="114.5" x2="267.5" y1="195.6953" y2="195.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="126.5" y="190.7622">Intercept Transaction</text><polygon fill="#A80036" points="468.8333,220.8281,478.8333,224.8281,468.8333,228.8281,472.8333,224.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="268.5" x2="474.8333" y1="224.8281" y2="224.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="275.5" y="219.895">TLS connect</text><path d="M225,237.9609 L225,262.9609 L522,262.9609 L522,247.9609 L512,237.9609 L225,237.9609 " fill="#FBFB77" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M512,237.9609 L512,247.9609 L522,247.9609 L512,237.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="321.9167" y="255.0278">Secure Tunnel</text><polygon fill="#A80036" points="468.8333,289.0938,478.8333,293.0938,468.8333,297.0938,472.8333,293.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="268.5" x2="474.8333" y1="293.0938" y2="293.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="275.5" y="288.1606">HTTP CONNECT</text><path d="M410,306.2266 L410,346.2266 L546,346.2266 L546,316.2266 L536,306.2266 L410,306.2266 " fill="#FBFB77" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M536,306.2266 L536,316.2266 L546,316.2266 L536,306.2266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="416" y="323.2935">DNS for Service is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="416" y="338.4263">done here.</text><polygon fill="#A80036" points="573.8333,372.4922,583.8333,376.4922,573.8333,380.4922,577.8333,376.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="480.8333" x2="579.8333" y1="376.4922" y2="376.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="487.8333" y="371.5591">TCP Connect</text><path d="M8,389.625 L8,429.625 L608,429.625 L608,399.625 L598,389.625 L8,389.625 " fill="#FBFB77" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M598,389.625 L598,399.625 L608,399.625 L598,389.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="362" x="67.4167" y="406.6919">At this point data can flow between the Client and Server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="469" x="67.4167" y="421.8247">over the secure link as a virtual connection, including any TLS handshake.</text><polygon fill="#A80036" points="41.5,440.8906,31.5,444.8906,41.5,448.8906,37.5,444.8906" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="573.8333,440.8906,583.8333,444.8906,573.8333,448.8906,577.8333,444.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="35.5" x2="579.8333" y1="444.8906" y2="444.8906"/><polygon fill="#A80036" points="120.5,469.8906,110.5,473.8906,120.5,477.8906,116.5,473.8906" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="256.5,469.8906,266.5,473.8906,256.5,477.8906,260.5,473.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="114.5" x2="262.5" y1="473.8906" y2="473.8906"/><path d="M130.75,461.1901 L127.5,464.4737 L130.75,467.6901 L130.75,465.5234 L136.1667,465.5234 L136.1667,463.3568 L130.75,463.3568 L130.75,461.1901 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="141.1667" y="468.9575">Move data</text><path d="M218.5833,461.1901 L218.5833,463.3568 L213.1667,463.3568 L213.1667,465.5234 L218.5833,465.5234 L218.5833,467.6901 L221.8333,464.4065 L218.5833,461.1901 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><polygon fill="#A80036" points="279.5,499.0234,269.5,503.0234,279.5,507.0234,275.5,503.0234" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="376.8333,499.0234,386.8333,503.0234,376.8333,507.0234,380.8333,503.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="273.5" x2="382.8333" y1="503.0234" y2="503.0234"/><path d="M289.75,490.3229 L286.5,493.6065 L289.75,496.8229 L289.75,494.6563 L295.1667,494.6563 L295.1667,492.4896 L289.75,492.4896 L289.75,490.3229 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="300.1667" y="498.0903">Move data</text><path d="M377.5833,490.3229 L377.5833,492.4896 L372.1667,492.4896 L372.1667,494.6563 L377.5833,494.6563 L377.5833,496.8229 L380.8333,493.5393 L377.5833,490.3229 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><path d="M152,516.1563 L152,541.1563 L380,541.1563 L380,526.1563 L370,516.1563 L152,516.1563 " fill="#FBFB77" filter="url(#fky13cbuczy0s)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M370,516.1563 L370,526.1563 L380,526.1563 L370,516.1563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="158" y="533.2231">Plugin explicitly moves this data.</text><!--
@startuml

box "Client Network" #DDFFDD
actor Client
entity "User Agent\nVConn" as lvc
participant "Ingress ATS" as ingress
entity "Upstream\nVConn" as rvc
end box
box "Corporate Network" #DDDDFF
participant "Peer ATS" as peer
database Service
end box

Client -> ingress : TCP or TLS connect
activate lvc
Client -> ingress : HTTP CONNECT
ingress -> lvc : Intercept Transaction
ingress -> peer : TLS connect
activate rvc
note over ingress,peer : Secure Tunnel
ingress -> peer : HTTP CONNECT
note over peer : DNS for Service is\ndone here.
peer -> Service : TCP Connect

note over Client, Service : At this point data can flow between the Client and Server\nover the secure link as a virtual connection, including any TLS handshake.
Client <- -> Service
lvc <-> ingress : <&arrow-thick-left> Move data <&arrow-thick-right>
ingress <-> rvc : <&arrow-thick-left> Move data <&arrow-thick-right>
note over ingress : Plugin explicitly moves this data.

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>