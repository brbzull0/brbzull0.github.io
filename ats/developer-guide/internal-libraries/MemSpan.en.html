


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>MemSpan &mdash; Apache Traffic Server 10.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/override.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="TS.Scalar" href="scalar.en.html" />
    <link rel="prev" title="TextView" href="TextView.en.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Apache Traffic Server
          

          
            
            <img src="../../_static/trans_logo_tm_380x69.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.en.html">Administrator’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.en.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-process/index.en.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.en.html">Contributing to Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-with-vagrant/index.en.html">Using Vagrant to Test Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging/index.en.html">Debugging and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../threads-and-events.en.html">Threads and Event Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cache-architecture/index.en.html">Cache Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging-architecture/index.en.html">Logging Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.en.html">Internal libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="TextView.en.html">TextView</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">MemSpan</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html">TS.Scalar</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="scalar.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="buffer-writer.en.html">BufferWriter</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html">IntrusiveDList</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-list.en.html#design-notes">Design Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html">IntrusiveHashMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#details">Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="intrusive-hash-map.en.html#design-notes">Design Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="MemArena.en.html">MemArena</a></li>
<li class="toctree-l3"><a class="reference internal" href="AcidPtr.en.html">AcidPtr &amp; AcidCommitPtr</a></li>
<li class="toctree-l3"><a class="reference internal" href="Extendible.en.html">Extendible</a></li>
<li class="toctree-l3"><a class="reference internal" href="ArgParser.en.html">ArgParser</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.en.html">Plugin Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config-vars.en.html">Configuration Variable Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.en.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../continuous-integration/index.en.html">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/index.en.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../host-resolution-proposal.en.html">Host Resolution Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-session-architecture.en.html">An Overview Client Sessions and Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-architecture/index.en.html">Core Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-documents/index.en.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layout/index.en.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/index.en.html">Testing Traffic Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.en.html">Appendices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apache Traffic Server</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.en.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.en.html">Internal libraries</a> &raquo;</li>
        
      <li>MemSpan</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/developer-guide/internal-libraries/MemSpan.en.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="memspan">
<h1>MemSpan<a class="headerlink" href="#memspan" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ts/MemSpan.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p><a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MemSpan</span></code></a> is a view on a contiguous section of writeable memory. A view does not own the memory
and neither allocates nor de-allocates. The memory in the view is always owned by some other container
and it is the responsibility of the code to make sure the lifetime of the view is no more than that
of the owning container <a class="footnote-reference brackets" href="#vector" id="id1">1</a>.</p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">MemSpan</span></code></a> is generally constructed on either an array or an allocated buffer. This allows
the buffer to be passed around with intrinsic length information. The buffer can also be treated as
an array of varying types, which makes working with serialized data much easier.</p>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<dl class="cpp class">
<dt id="_CPPv47MemSpan">
<span id="_CPPv37MemSpan"></span><span id="_CPPv27MemSpan"></span><span id="MemSpan"></span><em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">MemSpan</span></code><a class="headerlink" href="#_CPPv47MemSpan" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A span of writable memory. Because this is a chunk of memory, conceptually delimited by start and
end pointers, the sizing type is <code class="code docutils literal notranslate"><span class="pre">ptrdiff_t</span></code> so that all of the sizing is consistent with
differences between pointers. The memory is owned by some other object and that object must
maintain the memory as long as the span references it.</p>
<dl class="cpp function">
<dt id="_CPPv4N7MemSpan7MemSpanEPv9ptrdiff_t">
<span id="_CPPv3N7MemSpan7MemSpanEPv9ptrdiff_t"></span><span id="_CPPv2N7MemSpan7MemSpanEPv9ptrdiff_t"></span><span id="MemSpan::MemSpan__voidP.ptrdiff_t"></span><code class="sig-name descname"><span class="pre">MemSpan</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">ptr</span></em>, <a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <em><span class="pre">size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7MemSpan7MemSpanEPv9ptrdiff_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct a view starting at <em>ptr</em> for <em>size</em> bytes.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK7MemSpan4dataEv">
<span id="_CPPv3NK7MemSpan4dataEv"></span><span id="_CPPv2NK7MemSpan4dataEv"></span><span id="MemSpan::dataC"></span><span class="pre">void</span> <span class="pre">*</span><code class="sig-name descname"><span class="pre">data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4NK7MemSpan4dataEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a pointer to the first byte of the span.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK7MemSpan4sizeEv">
<span id="_CPPv3NK7MemSpan4sizeEv"></span><span id="_CPPv2NK7MemSpan4sizeEv"></span><span id="MemSpan::sizeC"></span><a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <code class="sig-name descname"><span class="pre">size</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4NK7MemSpan4sizeEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the size of the span.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK7MemSpaneqERK7MemSpan">
<span id="_CPPv3NK7MemSpaneqERK7MemSpan"></span><span id="_CPPv2NK7MemSpaneqERK7MemSpan"></span><span id="MemSpan::eq-operator__MemSpanCRC"></span><span class="pre">bool</span> <code class="sig-name descname"><span class="pre">operator==</span></code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><span class="pre">MemSpan</span></a> <em class="property"><span class="pre">const</span></em> <span class="pre">&amp;</span><em><span class="pre">that</span></em><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4NK7MemSpaneqERK7MemSpan" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check the equality of two spans, which are equal if they contain the same number of bytes of the same values.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK7MemSpan7is_sameERK7MemSpan">
<span id="_CPPv3NK7MemSpan7is_sameERK7MemSpan"></span><span id="_CPPv2NK7MemSpan7is_sameERK7MemSpan"></span><span id="MemSpan::is_same__MemSpanCRC"></span><span class="pre">bool</span> <code class="sig-name descname"><span class="pre">is_same</span></code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><span class="pre">MemSpan</span></a> <em class="property"><span class="pre">const</span></em> <span class="pre">&amp;</span><em><span class="pre">that</span></em><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4NK7MemSpan7is_sameERK7MemSpan" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if <em>that</em> is the same span as <em>this</em>, that is the spans contain the exact same bytes.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4I0ENK7MemSpan2atE1V9ptrdiff_t">
<span id="_CPPv3I0ENK7MemSpan2atE9ptrdiff_t"></span><span id="_CPPv2I0ENK7MemSpan2atE9ptrdiff_t"></span><span class="pre">template&lt;</span><span class="pre">typename</span> <code class="sig-name descname"><span class="pre">V</span></code><span class="pre">&gt;</span><br /><a class="reference internal" href="#_CPPv4I0ENK7MemSpan2atE1V9ptrdiff_t" title="MemSpan::at::V"><span class="pre">V</span></a> <code class="sig-name descname"><span class="pre">at</span></code><span class="sig-paren">(</span><a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <em><span class="pre">n</span></em><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4I0ENK7MemSpan2atE1V9ptrdiff_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a value of type <em>V</em> as if the span were are array of type <em>V</em>.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4I0ENK7MemSpan3ptrEP1V9ptrdiff_t">
<span id="_CPPv3I0ENK7MemSpan3ptrE9ptrdiff_t"></span><span id="_CPPv2I0ENK7MemSpan3ptrE9ptrdiff_t"></span><span class="pre">template&lt;</span><span class="pre">typename</span> <code class="sig-name descname"><span class="pre">V</span></code><span class="pre">&gt;</span><br /><a class="reference internal" href="#_CPPv4I0ENK7MemSpan3ptrEP1V9ptrdiff_t" title="MemSpan::ptr::V"><span class="pre">V</span></a> <span class="pre">*</span><code class="sig-name descname"><span class="pre">ptr</span></code><span class="sig-paren">(</span><a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <em><span class="pre">n</span></em><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4I0ENK7MemSpan3ptrEP1V9ptrdiff_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a pointer to a value of type <em>V</em> as if the span were are array of type <em>V</em>.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK7MemSpan6prefixE9ptrdiff_t">
<span id="_CPPv3NK7MemSpan6prefixE9ptrdiff_t"></span><span id="_CPPv2NK7MemSpan6prefixE9ptrdiff_t"></span><span id="MemSpan::prefix__ptrdiff_tC"></span><a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><span class="pre">MemSpan</span></a> <code class="sig-name descname"><span class="pre">prefix</span></code><span class="sig-paren">(</span><a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <em><span class="pre">n</span></em><span class="sig-paren">)</span> <em class="property"><span class="pre">const</span></em><a class="headerlink" href="#_CPPv4NK7MemSpan6prefixE9ptrdiff_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return a new instance that contains the first <em>n</em> bytes of the current span. If <em>n</em>
is larger than the number of bytes in the span, only that many bytes are returned.</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N7MemSpan13remove_prefixE9ptrdiff_t">
<span id="_CPPv3N7MemSpan13remove_prefixE9ptrdiff_t"></span><span id="_CPPv2N7MemSpan13remove_prefixE9ptrdiff_t"></span><span id="MemSpan::remove_prefix__ptrdiff_t"></span><a class="reference internal" href="#_CPPv47MemSpan" title="MemSpan"><span class="pre">MemSpan</span></a> <span class="pre">&amp;</span><code class="sig-name descname"><span class="pre">remove_prefix</span></code><span class="sig-paren">(</span><a class="reference internal" href="../api/types/SystemTypes.en.html#_CPPv49ptrdiff_t" title="ptrdiff_t"><span class="pre">ptrdiff_t</span></a> <em><span class="pre">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7MemSpan13remove_prefixE9ptrdiff_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Remove the first <em>n</em> bytes of the span. If <em>n</em> is more than the number of bytes in
the span the result is an empty span. A reference to the instance is returned.</p>
</dd></dl>

</dd></dl>

<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="vector"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Strong caution must be used with containers such as <code class="code docutils literal notranslate"><span class="pre">std::vector</span></code> or <code class="code docutils literal notranslate"><span class="pre">std::string</span></code>
because the lifetime of the memory can be much less than the lifetime of the container. In
particular, adding or removing any element from a <code class="code docutils literal notranslate"><span class="pre">std::vector</span></code> can cause a re-allocation,
invalidating any view of the original memory. In general views should be treated like iterators,
suitable for passing to nested function calls but not for storing.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="scalar.en.html" class="btn btn-neutral float-right" title="TS.Scalar" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="TextView.en.html" class="btn btn-neutral float-left" title="TextView" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, dev@trafficserver.apache.org.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>
 


</body>
</html>