


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Security &mdash; Apache Traffic Server 10.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/override.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Mututal TLS" href="mtls.en.html" />
    <link rel="prev" title="Interacting with Traffic Server" href="../interaction/index.en.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Apache Traffic Server
          

          
            
            <img src="../../_static/trans_logo_tm_380x69.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.en.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.en.html">Installing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.en.html">Proxy Cache Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interaction/index.en.html">Interacting with Traffic Server</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mtls.en.html">Mututal TLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-access">Controlling Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-ssl-termination">Basic SSL Termination</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#client-and-traffic-server-connections">Client and Traffic Server Connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ts-and-origin-server-connections">Traffic Server and Origin Server Connections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mtls-en"><span class="xref std std-doc">mtls.en</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rotating-tls-session-ticket-keys">Rotating TLS Session Ticket Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ocsp-stapling">OCSP Stapling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#split-dns">Split DNS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.en.html">Cache Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.en.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.en.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring/index.en.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuring-traffic-server.en.html">Configuring Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layer-4-routing.en.html">Layer 4 Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance/index.en.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.en.html">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.en.html#audience">Audience</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guide/index.en.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.en.html">Appendices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apache Traffic Server</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.en.html">Administrator’s Guide</a> &raquo;</li>
        
      <li>Security</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/admin-guide/security/index.en.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="security">
<span id="admin-security"></span><h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="controlling-access">
<span id="admin-controlling-access"></span><h2>Controlling Access<a class="headerlink" href="#controlling-access" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server can be configured to allow only certain clients to use
the proxy cache.</p>
<ol class="arabic simple">
<li><p>Add a line to <a class="reference internal" href="../files/ip_allow.yaml.en.html#std-configfile-ip_allow.yaml"><code class="xref std std-file docutils literal notranslate"><span class="pre">ip_allow.yaml</span></code></a> for each IP address or
range of IP addresses allowed to access Traffic Server.</p></li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl_jsonrpc.en.html#cmdoption-traffic_ctl-config-arg-reload"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">config</span> <span class="pre">reload</span></code></a> to apply the configuration
changes.</p></li>
</ol>
</div>
<div class="section" id="basic-ssl-termination">
<span id="admin-ssl-termination"></span><h2>Basic SSL Termination<a class="headerlink" href="#basic-ssl-termination" title="Permalink to this headline">¶</a></h2>
<p>The Traffic Server <em>SSL termination</em> option enables you to secure
connections in reverse proxy mode between a client and a Traffic Server
and/or Traffic Server and an origin server.</p>
<p>The following sections describe how to enable and configure the SSL
termination option.</p>
<ul class="simple">
<li><p>Enable and configure SSL termination for client/Traffic Server
connections: <a class="reference internal" href="#client-and-traffic-server-connections"><span class="std std-ref">Client and Traffic Server Connections</span></a></p></li>
<li><p>Enable and configure SSL termination for Traffic Server/origin server
connections: <a class="reference internal" href="#traffic-server-and-origin-server-connections"><span class="std std-ref">Traffic Server and Origin Server Connections</span></a></p></li>
</ul>
<div class="section" id="client-and-traffic-server-connections">
<span id="id1"></span><h3>Client and Traffic Server Connections<a class="headerlink" href="#client-and-traffic-server-connections" title="Permalink to this headline">¶</a></h3>
<p>The figure below illustrates communication between a client and Traffic Server
(and between Traffic Server and an origin server) when the SSL
termination option is enabled and configured for Client/Traffic
Server connections only.</p>
<div class="figure align-center" id="id2">
<img alt="Client and |TS| communication using SSL termination" src="../../_images/ssl_c.jpg" />
<p class="caption"><span class="caption-text">Client and Traffic Server communication using SSL termination</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>The figure above depicts the following:</p>
<ol class="arabic simple">
<li><p>The client sends an HTTPS request for content. Traffic Server receives the
request and performs the SSL handshake to authenticate the client (depending
on the authentication options configured) and determine the encryption
method that will be used. If the client is allowed access, then Traffic
Server checks its cache for the requested content.</p></li>
<li><p>If the request is a cache hit and the content is fresh, then Traffic Server
encrypts the content and sends it to the client. The client decrypts the
content (using the method determined during the handshake) and displays it.</p></li>
<li><p>If the request is a cache miss or cached content is stale, then Traffic
Server communicates with the origin server via HTTP and obtains a plain text
version of the content. Traffic Server saves the plain text version of the
content in its cache, encrypts the content, and sends it to the client. The
client decrypts and displays the content.</p></li>
</ol>
<p>To configure Traffic Server to use the SSL termination option for
Client/Traffic Server connections, you must do the following:</p>
<ol class="arabic">
<li><p>Obtain and install an SSL server certificate from a recognized
certificate authority. The SSL server certificate contains
information that enables the client to authenticate Traffic Server
and exchange encryption keys.</p></li>
<li><p>Set the port number used for SSL communication using
<a class="reference internal" href="../files/records.config.en.html#proxy-config-http-server-ports" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.http.server_ports</span></code></a> in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.</p></li>
<li><p>Set the appropriate base path for your SSL certificates and private keys
in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ts</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span>
<span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ts</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">keys</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>Add an entry to <a class="reference internal" href="../files/ssl_multicert.config.en.html#std-configfile-ssl_multicert.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">ssl_multicert.config</span></code></a> for each certificate and key
which your Traffic Server system will be using to terminate SSL connections
with clients.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dest_ip</span><span class="o">=</span><span class="mf">1.2</span><span class="o">.</span><span class="mf">3.4</span> <span class="n">ssl_cert_name</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">.</span><span class="n">pem</span>
<span class="n">dest_ip</span><span class="o">=*</span> <span class="n">ssl_cert_name</span><span class="o">=</span><span class="n">default</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
</li>
<li><p><em>Optional</em>: Configure the use of client certificates using the variable
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-certification-level" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.certification_level</span></code></a> in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.
If you configure Traffic Server to require client certificates, then Traffic
Server verifies the client certificate during the SSL handshake that
authenticates the client. If you configure Traffic Server to not require
client certificates, or if you configure certificates to be optional and the
connecting client does not present one, then access to Traffic Server is
managed through other Traffic Server options that have been set (such as
rules in <a class="reference internal" href="../files/ip_allow.yaml.en.html#std-configfile-ip_allow.yaml"><code class="xref std std-file docutils literal notranslate"><span class="pre">ip_allow.yaml</span></code></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">certification_level</span> <span class="n">INT</span> <span class="mi">0</span>
</pre></div>
</div>
<p>This variable permits one of the following values to be set:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 94%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>Client certificates not required.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>Client certificates optional. If present, will be used to validate.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>Client certificates required, and must validate based on configured CAs.</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><em>Optional</em>: Configure the use of Certification Authorities (CAs). CAs add
security by verifying the identity of the person requesting a certificate.
The list of acceptable CA signers is configured with
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ca-cert-path" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.CA.cert.path</span></code></a> in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">CA</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">CA</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">private</span><span class="o">-</span><span class="n">ca</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
</li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl.en.html#cmdoption-traffic_ctl-server-arg-restart"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">server</span> <span class="pre">restart</span></code></a> to restart Traffic Server.</p></li>
</ol>
</div>
<div class="section" id="ts-and-origin-server-connections">
<span id="traffic-server-and-origin-server-connections"></span><h3>Traffic Server and Origin Server Connections<a class="headerlink" href="#ts-and-origin-server-connections" title="Permalink to this headline">¶</a></h3>
<p>The figure below illustrates communication between Traffic Server and an
origin server when the SSL termination option is enabled for Traffic
Server/origin server connections.</p>
<div class="figure align-center" id="id3">
<img alt="|TS| and origin server communication using SSL termination" src="../../_images/ssl_os.jpg" />
<p class="caption"><span class="caption-text">Traffic Server and origin server communication using SSL termination</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The figure above depicts the following:</p>
<ol class="arabic simple">
<li><p>If a client request is a cache miss or is stale, then Traffic Server sends
an HTTPS request for the content to the origin server. The origin server
receives the request and performs the SSL handshake to authenticate Traffic
Server and determine the encryption method to be used.</p></li>
<li><p>If Traffic Server is allowed access, then the origin server encrypts the
content and sends it to Traffic Server, where it is decrypted (using the
method determined during the handshake). A plain text version of the content
is saved in the cache, if Traffic Server deems the content cacheable.</p></li>
<li><p>If SSL termination is enabled for Client/Traffic Server connections, then
Traffic Server re-encrypts the content and sends it to the client via HTTPS,
where it is decrypted and displayed. If SSL termination is not enabled for
Client/Traffic Server connections, then Traffic Server sends the plain text
version of the content to the client via HTTP.</p></li>
</ol>
<p>To configure Traffic Server to use the SSL termination option for Traffic Server
and origin server connections, you must do the following:</p>
<ol class="arabic">
<li><p>Ensure first that your origin server responds properly to SSL requests, and
configure it for client certificate validation if you intend to use that as
part of your access control scheme.</p>
<p>Refer to your origin server’s documentation for details. If your origin
server is another Traffic Server system, then you may follow the steps
outlined in <a class="reference internal" href="#id1">Client and Traffic Server Connections</a> for configuring the
origin server to validate client certificates.</p>
</li>
<li><p><em>Optional</em>: Obtain and install an SSL client certificate from a recognized
certificate authority, if your origin server requires client certificate
validation for access control. Your client certificate must be signed by a
Certificate Authority recognized by your origin server.</p>
<p>If you are using a client certificate, you must add its location to
<a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a> in the setting <a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-cert-path" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.cert.path</span></code></a>
and <a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-cert-filename" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.cert.filename</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ts</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span>
<span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">filename</span> <span class="n">STRING</span> <span class="n">client</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
<p>You must also provide the paths to the private key for this certificate,
unless the key is contained within the same file as the certificate, using
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-private-key-path" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.private_key.path</span></code></a> and
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-private-key-filename" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.private_key.filename</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ts</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">keys</span><span class="o">/</span>
<span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">filename</span> <span class="n">STRING</span> <span class="n">client</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
</li>
<li><p>Enable or disable, per your security policy, server SSL certificate
verification using <a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-verify-server-policy" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.verify.server.policy</span></code></a> in
<a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">verify</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">policy</span> <span class="n">STRING</span> <span class="n">ENFORCED</span>
</pre></div>
</div>
</li>
<li><p>Add the collection of authorized Certificate Authorities to the Traffic
Server configuration in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a> using the settings
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-ca-cert-path" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.CA.cert.path</span></code></a> and
<a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-client-ca-cert-filename" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.client.CA.cert.filename</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">CA</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">path</span> <span class="n">STRING</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">ts</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span>
<span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">CA</span><span class="o">.</span><span class="n">cert</span><span class="o">.</span><span class="n">filename</span> <span class="n">STRING</span> <span class="n">CAs</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
</li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl.en.html#cmdoption-traffic_ctl-server-arg-restart"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">server</span> <span class="pre">restart</span></code></a> to restart Traffic Server.</p></li>
</ol>
</div>
</div>
<div class="section" id="mtls-en">
<h2><a class="reference internal" href="mtls.en.html"><span class="doc">Mututal TLS</span></a><a class="headerlink" href="#mtls-en" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server allow for the fine-grained specification for TLS client certificates for both
client to Traffic Server connections and Traffic Server to origin server connections.</p>
</div>
<div class="section" id="rotating-tls-session-ticket-keys">
<span id="admin-rotating-tls-session-ticket-keys"></span><h2>Rotating TLS Session Ticket Keys<a class="headerlink" href="#rotating-tls-session-ticket-keys" title="Permalink to this headline">¶</a></h2>
<p>TLS sessions can be resumed through session tickets which are encrypted with
a session ticket key and stored on clients. For better security, the ticket keys
can be rotated periodically, say, every 24 hours. The ticket keys are stored in
a ticket key file as a reverse queue in 48-byte chunks.</p>
<ol class="arabic simple">
<li><p>Generate a new ticket key and push it to the beginning of the ticket key file.</p></li>
<li><p><em>Optional</em>: Delete the last ticket key from the ticket key file.</p></li>
<li><p>Touch <a class="reference internal" href="../files/ssl_multicert.config.en.html#std-configfile-ssl_multicert.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">ssl_multicert.config</span></code></a> to indicate that the SSL configuration is stale.</p></li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl_jsonrpc.en.html#cmdoption-traffic_ctl-config-arg-reload"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">config</span> <span class="pre">reload</span></code></a> to apply the new ticket key.</p></li>
</ol>
</div>
<div class="section" id="ocsp-stapling">
<span id="admin-ocsp-stapling"></span><h2>OCSP Stapling<a class="headerlink" href="#ocsp-stapling" title="Permalink to this headline">¶</a></h2>
<p>OCSP Stapling is an alternative approach to checking the revocation
status of an SSL certificate using the Online Certificate Status
Protocol.</p>
<p>Under the original OCSP implementation, clients requested a
certificate’s revocation status directly from the Certificate
Authority (CA) that issued the certificate.  This could cause
significant load on the CA servers since they were required to
provide a response to every client of a given certificate in real
time.</p>
<p>Enabling OCSP Stapling instructs Traffic Server to retrieve and cache the
revocation status of all configured SSL certificates, and present them to the
client when the client requests the status.  Traffic Server will automatically
query the OCSP responder specified in the SSL certificate to gather the latest
revocation status.  Traffic Server will then cache the results for each
configured certificate.  The location of the OCSP responder is taken from the
Authority Information Access field of the signed certificate. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authority</span> <span class="n">Information</span> <span class="n">Access</span><span class="p">:</span>
            <span class="n">OCSP</span> <span class="o">-</span> <span class="n">URI</span><span class="p">:</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ocsp</span><span class="o">.</span><span class="n">digicert</span><span class="o">.</span><span class="n">com</span>
            <span class="n">CA</span> <span class="n">Issuers</span> <span class="o">-</span> <span class="n">URI</span><span class="p">:</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">cacerts</span><span class="o">.</span><span class="n">digicert</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">DigiCertSHA2SecureServerCA</span><span class="o">.</span><span class="n">crt</span>
</pre></div>
</div>
<p>Traffic Server can also use prefetched OCSP stapling responses if ssl_ocsp_name parameter
is used in <a class="reference internal" href="../files/ssl_multicert.config.en.html#std-configfile-ssl_multicert.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">ssl_multicert.config</span></code></a>. Take into account that when using prefetched
OCSP stapling responses, Traffic Server will not refresh them and it should be done
externally. This can be done using OpenSSL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ openssl ocsp -issuer ca.crt -cert cert.crt -host ocsp.digicert.com:80 \
-header &quot;Host=ocsp.digicert.com&quot; -respout /var/cache/ocsp/cert.ocsp
</pre></div>
</div>
<p>Support for OCSP Stapling can be tested using the -status option of the OpenSSL client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ openssl s_client -connect mozillalabs.com:443 -status
...
======================================
OCSP Response Data:
    OCSP Response Status: successful (0x0)
    Response Type: Basic OCSP Response
    Version: 1 (0x0)
...
</pre></div>
</div>
<p>Details of the OCSP Stapling TLS extension can be found in <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc6961.html"><strong>RFC 6961</strong></a>.</p>
<p>To configure Traffic Server to use OCSP Stapling, edit the following variables
in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a> file:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ocsp-enabled" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.ocsp.enabled</span></code></a></p></li>
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ocsp-cache-timeout" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.ocsp.cache_timeout</span></code></a></p></li>
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ocsp-request-timeout" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.ocsp.request_timeout</span></code></a></p></li>
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ocsp-update-period" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.ocsp.update_period</span></code></a></p></li>
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-ssl-ocsp-response-path" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.ssl.ocsp.response.path</span></code></a></p></li>
</ul>
</div>
<div class="section" id="split-dns">
<span id="admin-split-dns"></span><h2>Split DNS<a class="headerlink" href="#split-dns" title="Permalink to this headline">¶</a></h2>
<p>The <em>Split DNS</em> option enables you to configure Traffic Server to use
multiple DNS servers, as dictated by your security requirements. For
example, you might configure Traffic Server to use one set of DNS
servers to resolve hostnames on your internal network, while allowing
DNS servers outside the firewall to resolve hosts on the Internet. This
maintains the security of your intranet, while continuing to provide
direct access to sites outside your organization.</p>
<p>To configure Split DNS:</p>
<ol class="arabic">
<li><p>Specify the rules for performing DNS server selection based on the
destination domain, the destination host, or a URL regular expression.
These rules are located in <a class="reference internal" href="../files/splitdns.config.en.html#std-configfile-splitdns.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">splitdns.config</span></code></a>.</p></li>
<li><p>Enable the <em>Split DNS</em> option by adjusting <a class="reference internal" href="../files/records.config.en.html#proxy-config-dns-splitdns-enabled" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.dns.splitDNS.enabled</span></code></a>
in <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dns</span><span class="o">.</span><span class="n">splitDNS</span><span class="o">.</span><span class="n">enabled</span> <span class="n">INT</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl_jsonrpc.en.html#cmdoption-traffic_ctl-config-arg-reload"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">config</span> <span class="pre">reload</span></code></a> to apply the configuration changes.</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mtls.en.html" class="btn btn-neutral float-right" title="Mututal TLS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../interaction/index.en.html" class="btn btn-neutral float-left" title="Interacting with Traffic Server" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, dev@trafficserver.apache.org

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>
 


</body>
</html>