


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Log Rotation and Retention &mdash; Apache Traffic Server 10.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/override.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Log Filters" href="filters.en.html" />
    <link rel="prev" title="Logging Cache Results" href="cache-results.en.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Apache Traffic Server
          

          
            
            <img src="../../_static/trans_logo_tm_380x69.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.en.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.en.html">Installing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.en.html">Proxy Cache Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interaction/index.en.html">Interacting with Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/index.en.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.en.html">Cache Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.en.html">Plugins</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.en.html">Logging</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="understanding.en.html">Understanding Traffic Server Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="destinations.en.html">Log Destinations</a></li>
<li class="toctree-l3"><a class="reference internal" href="formatting.en.html">Formatting Log Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache-results.en.html">Logging Cache Results</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Log Rotation and Retention</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rotation-options">Rotation Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#retention-options">Retention Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="filters.en.html">Log Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.en.html">Configuration Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring/index.en.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuring-traffic-server.en.html">Configuring Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layer-4-routing.en.html">Layer 4 Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance/index.en.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.en.html">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonrpc/index.en.html">JSONRPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.en.html#audience">Audience</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guide/index.en.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.en.html">Appendices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apache Traffic Server</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.en.html">Administrator’s Guide</a> &raquo;</li>
        
          <li><a href="index.en.html">Logging</a> &raquo;</li>
        
      <li>Log Rotation and Retention</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/admin-guide/logging/rotation.en.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="log-rotation-and-retention">
<span id="admin-logging-rotation-retention"></span><h1>Log Rotation and Retention<a class="headerlink" href="#log-rotation-and-retention" title="Permalink to this headline">¶</a></h1>
<p>Logging is a nearly indispensable part of any networked service, but especially
with high traffic installations care needs to be taken to ensure that log files
don’t exhaust storage space and cause maintenance or outage nightmares.</p>
<p>Traffic Server provides a two-pronged solution: log rotation (also called log rolling) to
keep individual logs as manageable in size as possible for easier ingestion and
analysis by humans and other programs, and log retention to keep logs from
using more space than available and necessary.</p>
<p>This section covers both features.</p>
<div class="section" id="rotation-options">
<span id="admin-logging-rotation"></span><h2>Rotation Options<a class="headerlink" href="#rotation-options" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server provides automatic log file rolling. At specific intervals during the day
or when log files reach a certain size, Traffic Server closes its current set of log
files and opens new log files. Depending on the amount of traffic your servers
are exposed to, you may find that increasing the frequency of log rolling is
beneficial, or even necessary, to maintain manageable log file sets. Traffic Server nodes
processing moderately high levels of traffic may want to start by rolling logs
every six hours, and adjusting from there.</p>
<p>Log file rolling offers the following benefits:</p>
<ul class="simple">
<li><p>It defines a consistent interval over which log analysis can be performed.</p></li>
<li><p>It keeps any single log file from becoming too large and helps to
keep the logging system within the specified space limits.</p></li>
<li><p>It provides an easy way to identify files that are no longer being
used so that an automated script can clean the logging directory and
run log analysis programs.</p></li>
</ul>
<div class="section" id="rolled-log-filename-format">
<h3>Rolled Log Filename Format<a class="headerlink" href="#rolled-log-filename-format" title="Permalink to this headline">¶</a></h3>
<p>Traffic Server provides a consistent naming scheme for rolled log files that enables you
to easily identify log files. When Traffic Server rolls a log file, it saves and closes
the old file before it starts a new file. Traffic Server renames the old file to include
the following information:</p>
<ul class="simple">
<li><p>The original log file’s name (such as <code class="docutils literal notranslate"><span class="pre">access.log</span></code>).</p></li>
<li><p>The hostname of the Traffic Server node that generated the log file.</p></li>
<li><p>Two timestamps separated by a hyphen (<code class="docutils literal notranslate"><span class="pre">-</span></code>). The first timestamp is
a <em>lower bound</em> for the timestamp of the first record in the log
file. The lower bound is the time when the new buffer for log records
is created. Under low load, the first timestamp in the filename can
be different from the timestamp of the first entry. Under normal
load, the first timestamp in the filename and the timestamp of the
first entry are similar. The second timestamp is an <em>upper bound</em>
for the timestamp of the last record in the log file (this is
normally the rolling time).</p></li>
<li><p>The suffix <code class="docutils literal notranslate"><span class="pre">.old</span></code>, which makes it easy for automated scripts to
find rolled log files.</p></li>
</ul>
<p>Timestamps have the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">Y</span><span class="o">%</span><span class="n">M</span><span class="o">%</span><span class="n">D</span><span class="o">.%</span><span class="n">Hh</span><span class="o">%</span><span class="n">Mm</span><span class="o">%</span><span class="n">Ss</span><span class="o">-%</span><span class="n">Y</span><span class="o">%</span><span class="n">M</span><span class="o">%</span><span class="n">D</span><span class="o">.%</span><span class="n">Hh</span><span class="o">%</span><span class="n">Mm</span><span class="o">%</span><span class="n">Ss</span>
</pre></div>
</div>
<p>The following table describes the format:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 79%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Sample</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%Y</span></code></p></td>
<td><p>The year in four-digit format.</p></td>
<td><p>2000</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%M</span></code></p></td>
<td><p>The month in two-digit format, from 01-12.</p></td>
<td><p>07</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%D</span></code></p></td>
<td><p>The day in two-digit format, from 01-31.</p></td>
<td><p>19</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%H</span></code></p></td>
<td><p>The hour in two-digit format, from 00-23.</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%M</span></code></p></td>
<td><p>The minute in two-digit format, from 00-59.</p></td>
<td><p>52</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%S</span></code></p></td>
<td><p>The second in two-digit format, from 00-59.</p></td>
<td><p>36</p></td>
</tr>
</tbody>
</table>
<p>The following is an example of a rolled log filename:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">mymachine</span><span class="mf">.20110912.12</span><span class="n">h00m00s</span><span class="o">-</span><span class="mf">20000913.12</span><span class="n">h00m00s</span><span class="o">.</span><span class="n">old</span>
</pre></div>
</div>
<p>The logging system buffers log records before writing them to disk. When
a log file is rolled, the log buffer might be partially full. If it is,
then the first entry in the new log file will have a timestamp earlier
than the time of rolling. When the new log file is rolled, its first
timestamp will be a lower bound for the timestamp of the first entry.</p>
<p>For example, suppose logs are rolled every three hours, and the first
rolled log file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">mymachine</span><span class="mf">.20110912.12</span><span class="n">h00m00s</span><span class="o">-</span><span class="mf">19980912.03</span><span class="n">h00m00s</span><span class="o">.</span><span class="n">old</span>
</pre></div>
</div>
<p>If the lower bound for the first entry in the log buffer at 3:00:00 is
2:59:47, then the next log file will have the following timestamp when
rolled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">mymachine</span><span class="mf">.20110912.02</span><span class="n">h59m47s</span><span class="o">-</span><span class="mf">19980912.06</span><span class="n">h00m00s</span><span class="o">.</span><span class="n">old</span>
</pre></div>
</div>
<p>The contents of a log file are always between the two timestamps. Log
files do not contain overlapping entries, even if successive timestamps
appear to overlap.</p>
</div>
<div class="section" id="rolling-intervals">
<h3>Rolling Intervals<a class="headerlink" href="#rolling-intervals" title="Permalink to this headline">¶</a></h3>
<p>Log files are rolled at specific intervals relative to a given hour of the day.
Three options may be used to control when log files are rolled:</p>
<ul class="simple">
<li><p>A file size threshold, which will prevent any individual log from growing
too large.</p></li>
<li><p>The offset hour, which is an hour between <code class="docutils literal notranslate"><span class="pre">0</span></code> (midnight) and <code class="docutils literal notranslate"><span class="pre">23</span></code>.</p></li>
<li><p>The rolling interval.</p></li>
</ul>
<p>Both the offset hour and the rolling interval determine when log file rolling
starts. Rolling occurs every <em>rolling interval</em> and at the <em>offset</em> hour. For
example, if the rolling interval is six hours and the offset hour is <code class="docutils literal notranslate"><span class="pre">0</span></code>
(midnight), then the logs will roll at midnight (00:00), 06:00, 12:00, and
18:00 each day. If the rolling interval is 12 hours and the offset hour is
<code class="docutils literal notranslate"><span class="pre">3</span></code>, then logs will roll at 03:00 and 15:00 each day.</p>
<p>To set log file rolling options and/or configure Traffic Server to roll log files when
they reach a certain size, adjust the following settings in
<a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>:</p>
<ol class="arabic">
<li><p>Enable log rolling with <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-enabled" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_enabled</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">rolling_enabled</span> <span class="n">INT</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p>Configure the upper limit on log file size with
<a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-size-mb" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_size_mb</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">rolling_size_mb</span> <span class="n">INT</span> <span class="mi">1024</span>
</pre></div>
</div>
</li>
<li><p>Set the offset hour with <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-offset-hr" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_offset_hr</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">rolling_offset_hr</span> <span class="n">INT</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>Set the interval (in seconds) with
<a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-interval-sec" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_interval_sec</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">rolling_interval_sec</span> <span class="n">INT</span> <span class="mi">21600</span>
</pre></div>
</div>
</li>
<li><p>Set the minimum number of rolled files with
<a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-min-count" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_min_count</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">proxy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">rolling_min_count</span> <span class="n">INT</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl_jsonrpc.en.html#cmdoption-traffic_ctl-config-arg-reload"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">config</span> <span class="pre">reload</span></code></a> to apply the configuration
changes.</p></li>
</ol>
<p>You can fine-tune log file rolling settings for individual log files in the
<code class="docutils literal notranslate"><span class="pre">log.*</span></code> specification in <a class="reference internal" href="../files/logging.yaml.en.html#std-configfile-logging.yaml"><code class="xref std std-file docutils literal notranslate"><span class="pre">logging.yaml</span></code></a>. The custom log file uses the
rolling settings provided in the relevant <code class="docutils literal notranslate"><span class="pre">log</span></code> function call, which override
the default settings you specify in Traffic Manager or <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a>
described above.</p>
</div>
</div>
<div class="section" id="retention-options">
<span id="admin-logging-retention"></span><h2>Retention Options<a class="headerlink" href="#retention-options" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server enables you to control the amount of disk space that the logging directory
can consume. This allows the system to operate smoothly within a specified
space window for a long period of time. After you establish a space limit,
Traffic Server continues to monitor the space in the logging directory. When the free
space dwindles to the headroom limit, it enters a low space state and takes the
following actions:</p>
<ul class="simple">
<li><p>If the autodelete option is enabled, then Traffic Server identifies previously-rolled
log files (log files with the <code class="docutils literal notranslate"><span class="pre">.old</span></code> extension). It starts deleting files
one by one, beginning with the oldest file with largest ratio between current
number of files and the minimum rolling count, until it emerges from the low
state. The default minimum rolling count of 0 is treated as INT_MAX during
ratio calculation. Hence the <cite>rolling_min_count</cite> is not guaranteed to be
reserved; instead, it is used as a reference to decide the priority of log
files to delete. In low space state, even when all log files are below minimum
count, Traffic Server still tries to delete files until it emerges from the low state.
Traffic Server logs a record of all deleted files in the system error log.</p></li>
<li><p>If the autodelete option is disabled or there are not enough old log files
to delete for the system to emerge from its low space state, then Traffic Server
issues a warning and continues logging until the allocated log space is
exhausted (which, if configured appropriately, will be well before your
actual filesystem space is fully consumed and causes additional problems).
At this point, event logging stops even though proxy traffic is still served
without client-visible interruption. Traffic Server resumes event logging when enough
space becomes available for it to exit the low space state. To make space
available, either explicitly increase the logging space limit or remove
files from the logging directory manually.</p></li>
</ul>
<p>You can run a <em class="manpage">cron(8)</em> script in conjunction with Traffic Server to
automatically remove old log files from the logging directory before Traffic Server
enters the low space state. Relocate the old log files to a temporary
partition, where you can run a variety of log analysis scripts. Following
analysis, either compress the logs and move to an archive location, or simply
delete them.</p>
<p>Traffic Server periodically checks the amount of log space used against both the log
space allocation configured by <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-max-space-mb-for-logs" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.max_space_mb_for_logs</span></code></a>
and the actual amount of space available on the disk partition. The used log
space is calculated by summing the size of all files present in the logging
directory and is published in the
<a class="reference internal" href="../monitoring/statistics/core/log.en.html#proxy-process-log-log-files-space-used" title="records.config"><code class="xref ts ts-stat docutils literal notranslate"><span class="pre">proxy.process.log.log_files_space_used</span></code></a> metric. The
<a class="reference internal" href="../files/records.config.en.html#proxy-config-log-max-space-mb-headroom" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.max_space_mb_headroom</span></code></a> configuration variable
specifies an amount of headroom that is subtracted from the log space
allocation. This can be tuned to reduce the risk of completely filling the disk
partition.</p>
<div class="section" id="setting-log-file-management-options">
<h3>Setting Log File Management Options<a class="headerlink" href="#setting-log-file-management-options" title="Permalink to this headline">¶</a></h3>
<p>To set log management options, follow the steps below:</p>
<ol class="arabic simple">
<li><p>In the <a class="reference internal" href="../files/records.config.en.html#std-configfile-records.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">records.config</span></code></a> file, edit the following variables</p>
<ul class="simple">
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-log-max-space-mb-for-logs" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.max_space_mb_for_logs</span></code></a></p></li>
<li><p><a class="reference internal" href="../files/records.config.en.html#proxy-config-log-max-space-mb-headroom" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.max_space_mb_headroom</span></code></a></p></li>
</ul>
</li>
<li><p>Run the command <a class="reference internal" href="../../appendices/command-line/traffic_ctl_jsonrpc.en.html#cmdoption-traffic_ctl-config-arg-reload"><code class="xref std std-option docutils literal notranslate"><span class="pre">traffic_ctl</span> <span class="pre">config</span> <span class="pre">reload</span></code></a> to apply the configuration
changes.</p></li>
</ol>
</div>
<div class="section" id="retaining-logs-for-no-more-than-a-specified-period">
<h3>Retaining Logs For No More Than a Specified Period<a class="headerlink" href="#retaining-logs-for-no-more-than-a-specified-period" title="Permalink to this headline">¶</a></h3>
<p>If for security reasons logs need to be purged to make sure no log entry remains on the box
for more then a specified period of time, we could achieve this by setting the rolling interval,
the maximum number of rolled log files, and forcing Traffic Server to roll even when there is no traffic.</p>
<p>Let us say we wanted the oldest log entry to be kept on the box to be no older than 2-hour old.</p>
<p>Set <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-interval-sec" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_interval_sec</span></code></a> (yaml: <cite>rolling_interval_sec</cite>) to 3600 (1h)
which will lead to rolling every 1h.</p>
<p>Set <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-max-count" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_max_count</span></code></a> (yaml: <cite>rolling_max_count</cite>) to 1
which will lead to keeping only one rolled log file at any moment (rolled will be trimmed on every roll).</p>
<p>Set <a class="reference internal" href="../files/records.config.en.html#proxy-config-log-rolling-allow-empty" title="records.config"><code class="xref ts ts-cv docutils literal notranslate"><span class="pre">proxy.config.log.rolling_allow_empty</span></code></a> (yaml: <cite>rolling_allow_empty</cite>) to 1 (default: 0)
which will allow logs to be open and rolled even if there was nothing to be logged during the previous period
(i.e. no requests to Traffic Server).</p>
<p>The above will ensure logs are rolled every 1h hour, only 1 rolled log file to be kept
(rest will be trimmed/removed) and logs will be rolling (“moving”) even if nothing is logged
(i.e. no traffic to Traffic Server).</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="filters.en.html" class="btn btn-neutral float-right" title="Log Filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="cache-results.en.html" class="btn btn-neutral float-left" title="Logging Cache Results" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, dev@trafficserver.apache.org.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>
 


</body>
</html>