

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Accessing Statistics &#8212; Apache Traffic Server 10.0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/override.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Core Statistics" href="core-statistics.en.html" />
    <link rel="prev" title="Statistics" href="index.en.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="accessing-statistics">
<span id="admin-stats-accessing"></span><h1>Accessing Statistics<a class="headerlink" href="#accessing-statistics" title="Permalink to this headline">¶</a></h1>
<p>There are currently two methods provided with Traffic Server to view statistics:
<a class="reference internal" href="#admin-stats-traffic-line"><span class="std std-ref">Traffic Control</span></a> and <a class="reference internal" href="#admin-stats-stats-over-http"><span class="std std-ref">Stats Over HTTP</span></a>.</p>
<div class="section" id="traffic-control">
<span id="admin-stats-traffic-line"></span><h2>Traffic Control<a class="headerlink" href="#traffic-control" title="Permalink to this headline">¶</a></h2>
<p>The command line utility <strong class="program">traffic_ctl</strong> offers a text based interface
for viewing Traffic Server statistics. Invocation is simple and requires knowing the
specific name of the statistic you wish you view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">traffic_ctl</span> <span class="n">metric</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">statistic</span> <span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>You may notice that this is the same utility, and argument, used for viewing
configuration variables of a running Traffic Server instance. Unlike configuration
variables, you cannot modify a statistic value with the <strong class="program">traffic_ctl</strong>
program.</p>
<p>This utility is enabled and built by default, and will be located in the
<code class="docutils literal notranslate"><span class="pre">bin/</span></code> subdirectory of your Traffic Server installation. There are no required changes
to your configuration to allow <strong class="program">traffic_ctl</strong> to function, however it
may only be run by users with permissions to access the Traffic Server Unix socket. This
will typically limit use to root as well as the system user you have configured
Traffic Server to run under or any other system users which share the same group as you
have configured Traffic Server to use.</p>
</div>
<div class="section" id="stats-over-http">
<span id="admin-stats-stats-over-http"></span><h2>Stats Over HTTP<a class="headerlink" href="#stats-over-http" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server includes a stable plugin, <a class="reference internal" href="../../plugins/stats_over_http.en.html#admin-plugins-stats-over-http"><span class="std std-ref">Stats Over HTTP Plugin</span></a>, which provides
HTTP access to all Traffic Server statistics. The plugin returns a JSON object with all
statistics and their current values. It is not possible to return a subset of
the statistics. The plugin must be enabled before you may use it.</p>
<div class="section" id="enabling-stats-over-http">
<span id="admin-stats-stats-over-http-enabling"></span><h3>Enabling Stats Over HTTP<a class="headerlink" href="#enabling-stats-over-http" title="Permalink to this headline">¶</a></h3>
<p>To enable the <a class="reference internal" href="../../plugins/stats_over_http.en.html#admin-plugins-stats-over-http"><span class="std std-ref">Stats Over HTTP Plugin</span></a> plugin, you must add the
following to your <a class="reference internal" href="../../files/plugin.config.en.html#std:configfile-plugin.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">plugin.config</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats_over_http</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>Once the plugin is enabled and Traffic Server has reloaded, you can test that it is
working properly by issuing a simple HTTP request with <code class="docutils literal notranslate"><span class="pre">curl</span></code>. Assuming your
Traffic Server installation is using the default interface and port bindings, running the
following command on the same host as Traffic Server should now work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">_stats</span>
</pre></div>
</div>
<p>You should be presented with an HTTP response containing a single JSON object
which lists all the available statistics and their current values. If you have
configured Traffic Server to only listen on a specific interface, or to use a different
port, you may need to adjust the URL in the command above.</p>
<p>If you wish to have the stats made available at a non-default path, then that
path should be given as the sole argument to the plugin, as so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats_over_http</span><span class="o">.</span><span class="n">so</span> <span class="mi">81</span><span class="n">c075bc0cca1435ea899ba4ad72766b</span>
</pre></div>
</div>
<p>The above <a class="reference internal" href="../../files/plugin.config.en.html#std:configfile-plugin.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">plugin.config</span></code></a> entry will result in your Traffic Server statistics being
located at <code class="docutils literal notranslate"><span class="pre">/81c075bc0cca1435ea899ba4ad72766b</span></code> on any host and port on which
you have your Traffic Server instance listening.</p>
</div>
<div class="section" id="statistics-security-and-privacy">
<span id="admin-stats-stats-over-http-security"></span><h3>Statistics Security and Privacy<a class="headerlink" href="#statistics-security-and-privacy" title="Permalink to this headline">¶</a></h3>
<p>Simply changing the path at which your statistics are available should be
considered very weak security. While cache objects themselves cannot be
accessed through the plugin’s JSON output, and no modifications to the
configuration or operation of Traffic Server may be made through the plugin, the
statistics may reveal much more about your network’s traffic and architecture
than you wish to be publicly available.</p>
<p>A better method is to use an <a class="reference internal" href="../../files/remap.config.en.html#remap-config-named-filters"><span class="std std-ref">ACL Filter</span></a> in
<a class="reference internal" href="../../files/remap.config.en.html#std:configfile-remap.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">remap.config</span></code></a> to restrict access to clients. For instance, if your Traffic Server
host resides on a private network in the 10.1.1.0/24 IPv4 address space
listening on the address 10.1.1.10, separate from its public interface(s) used
to serve client requests, you could add the following remap configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.10</span><span class="o">/</span><span class="n">_stats</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.10</span><span class="o">/</span><span class="n">_stats</span> <span class="nd">@action</span><span class="o">=</span><span class="n">deny</span> <span class="nd">@src_ip</span><span class="o">=</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">-</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span>
<span class="nb">map</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.10</span><span class="o">/</span><span class="n">_stats</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.10</span><span class="o">/</span><span class="n">_stats</span> <span class="nd">@action</span><span class="o">=</span><span class="n">allow</span> <span class="nd">@src_ip</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.255</span>
</pre></div>
</div>
<p>The above configuration sets the default policy for the entirety of IPv4 address
space to deny, but then exempts the 10.1.1.0/24 network by permitting their
requests to be processed by Traffic Server. If your monitoring infrastructure makes use
of locally-installed data collection agents, you may even wish to restrict
access to the Stats Over HTTP plugin to all but localhost.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/trans_logo_tm_380x69.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../index.html">Apache Traffic Server</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.en.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/index.en.html">Installing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/index.en.html">Proxy Cache Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interaction/index.en.html">Interacting with Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/index.en.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/index.en.html">Cache Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.en.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/index.en.html">Logging</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.en.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuring-traffic-server.en.html">Configuring Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layer-4-routing.en.html">Layer 4 Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../performance/index.en.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../files/index.en.html">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonrpc/index.en.html">JSONRPC API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.en.html#audience">Audience</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer-guide/index.en.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/index.en.html">Appendices</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.en.html">Administrator’s Guide</a><ul>
  <li><a href="../index.en.html">Monitoring</a><ul>
  <li><a href="index.en.html">Statistics</a><ul>
      <li>Previous: <a href="index.en.html" title="previous chapter">Statistics</a></li>
      <li>Next: <a href="core-statistics.en.html" title="next chapter">Core Statistics</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>

    <div class="footer">
      &copy;2021, dev@trafficserver.apache.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/admin-guide/monitoring/statistics/accessing.en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  </body>
</html>