<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="542px" preserveAspectRatio="none" style="width:492px;height:542px;" version="1.1" viewBox="0 0 492 542" width="492px" zoomAndPan="magnify"><defs><filter height="300%" id="fh0cgxssy8x23" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="27" x2="27" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="311" x2="311" y1="86.2969" y2="454.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="430" x2="430" y1="86.2969" y2="454.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="82.9951">User</text><ellipse cx="27" cy="13" fill="#FEFECE" filter="url(#fh0cgxssy8x23)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,21 L27,48 M14,29 L40,29 M27,48 L14,63 M27,48 L40,63 " fill="none" filter="url(#fh0cgxssy8x23)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="466.8857">User</text><ellipse cx="27" cy="480.1875" fill="#FEFECE" filter="url(#fh0cgxssy8x23)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,488.1875 L27,515.1875 M14,496.1875 L40,496.1875 M27,515.1875 L14,530.1875 M27,515.1875 L40,530.1875 " fill="none" filter="url(#fh0cgxssy8x23)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fh0cgxssy8x23)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="256" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="263" y="70.9951">Traffic_Server</text><rect fill="#FEFECE" filter="url(#fh0cgxssy8x23)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="256" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="263" y="473.8857">Traffic_Server</text><rect fill="#FEFECE" filter="url(#fh0cgxssy8x23)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="376" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="383" y="70.9951">Origin_Server</text><rect fill="#FEFECE" filter="url(#fh0cgxssy8x23)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="376" y="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="383" y="473.8857">Origin_Server</text><polygon fill="#A80036" points="299,113.2969,309,117.2969,299,121.2969,303,117.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="305" y1="117.2969" y2="117.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="34" y="112.3638">CONNECT request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="311" x2="353" y1="161.6953" y2="161.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353" x2="353" y1="161.6953" y2="174.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="312" x2="353" y1="174.6953" y2="174.6953"/><polygon fill="#A80036" points="322,170.6953,312,174.6953,322,178.6953,318,174.6953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="318" y="141.4966">Route CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="318" y="156.6294">back to self</text><polygon fill="#A80036" points="299,199.6953,309,203.6953,299,207.6953,303,203.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="305" y1="203.6953" y2="203.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="34" y="198.7622">Client Hello</text><polygon fill="#A80036" points="38,228.8281,28,232.8281,38,236.8281,34,232.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="310" y1="232.8281" y2="232.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="44" y="227.895">Server Hello with fake certs from certifier</text><polygon fill="#A80036" points="299,257.9609,309,261.9609,299,265.9609,303,261.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="305" y1="261.9609" y2="261.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="34" y="257.0278">ClientKeyExchange ChangeCipherSpec</text><polygon fill="#A80036" points="38,287.0938,28,291.0938,38,295.0938,34,291.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="310" y1="291.0938" y2="291.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="44" y="286.1606">ChangeCipherSpec</text><polygon fill="#A80036" points="38,316.2266,28,320.2266,38,324.2266,34,320.2266" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="299,316.2266,309,320.2266,299,324.2266,303,320.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="305" y1="320.2266" y2="320.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="44" y="315.2935">Tunnel established</text><polygon fill="#A80036" points="299,345.3594,309,349.3594,299,353.3594,303,349.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="305" y1="349.3594" y2="349.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="34" y="344.4263">User request via tunnel</text><polygon fill="#A80036" points="418.5,374.4922,428.5,378.4922,418.5,382.4922,422.5,378.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="311" x2="424.5" y1="378.4922" y2="378.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="318" y="373.5591">Request</text><polygon fill="#A80036" points="322,403.625,312,407.625,322,411.625,318,407.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="429.5" y1="407.625" y2="407.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="328" y="402.6919">Response</text><polygon fill="#A80036" points="38,432.7578,28,436.7578,38,440.7578,34,436.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="310" y1="436.7578" y2="436.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="44" y="431.8247">TS response via tunnel</text><!--
@startuml
actor User
participant Traffic_Server
participant Origin_Server
User -> Traffic_Server: CONNECT request
Traffic_Server -> Traffic_Server: Route CONNECT\nback to self
User -> Traffic_Server: Client Hello
Traffic_Server -> User: Server Hello with fake certs from certifier
User -> Traffic_Server: ClientKeyExchange ChangeCipherSpec
Traffic_Server -> User: ChangeCipherSpec
User <-> Traffic_Server: Tunnel established
User -> Traffic_Server: User request via tunnel
Traffic_Server -> Origin_Server: Request
Origin_Server -> Traffic_Server: Response
Traffic_Server -> User: TS response via tunnel

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>