<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="412px" preserveAspectRatio="none" style="width:557px;height:412px;" version="1.1" viewBox="0 0 557 412" width="557px" zoomAndPan="magnify"><defs><filter height="300%" id="fywauudv5rfq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="30" x2="30" y1="86.2969" y2="325.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="181" x2="181" y1="86.2969" y2="325.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="332.5" x2="332.5" y1="86.2969" y2="325.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="82.9951">Client</text><ellipse cx="30.5" cy="13" fill="#FEFECE" filter="url(#fywauudv5rfq)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,21 L30.5,48 M17.5,29 L43.5,29 M30.5,48 L17.5,63 M30.5,48 L43.5,63 " fill="none" filter="url(#fywauudv5rfq)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="337.0889">Client</text><ellipse cx="30.5" cy="350.3906" fill="#FEFECE" filter="url(#fywauudv5rfq)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,358.3906 L30.5,385.3906 M17.5,366.3906 L43.5,366.3906 M30.5,385.3906 L17.5,400.3906 M30.5,385.3906 L43.5,400.3906 " fill="none" filter="url(#fywauudv5rfq)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fywauudv5rfq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="136" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="143" y="70.9951">Ingress TS</text><rect fill="#FEFECE" filter="url(#fywauudv5rfq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="136" y="324.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="143" y="344.0889">Ingress TS</text><rect fill="#FEFECE" filter="url(#fywauudv5rfq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="298.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="305.5" y="70.9951">Service</text><rect fill="#FEFECE" filter="url(#fywauudv5rfq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="298.5" y="324.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="305.5" y="344.0889">Service</text><polygon fill="#008000" points="41.5,113.2969,31.5,117.2969,41.5,121.2969,37.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="169.5,113.2969,179.5,117.2969,169.5,121.2969,173.5,117.2969" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="35.5" x2="175.5" y1="117.2969" y2="117.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="47.5" y="112.3638">TCP Connect</text><polygon fill="#0000FF" points="169.5,142.4297,179.5,146.4297,169.5,150.4297,173.5,146.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="30.5" x2="175.5" y1="146.4297" y2="146.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="37.5" y="141.4966">TLS:</text><text fill="#0000FF" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="68.5" y="141.4966">CLIENT HELLO</text><path d="M75,159.5625 L75,184.5625 L283,184.5625 L283,169.5625 L273,159.5625 L75,159.5625 " fill="#FBFB77" filter="url(#fywauudv5rfq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M273,159.5625 L273,169.5625 L283,169.5625 L273,159.5625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="81" y="176.6294">Map SNI to upstream Service</text><polygon fill="#008000" points="192.5,210.6953,182.5,214.6953,192.5,218.6953,188.5,214.6953" style="stroke: #008000; stroke-width: 1.0;"/><polygon fill="#008000" points="320.5,210.6953,330.5,214.6953,320.5,218.6953,324.5,214.6953" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="186.5" x2="326.5" y1="214.6953" y2="214.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="198.5" y="209.7622">TCP Connect</text><polygon fill="#0000FF" points="320.5,244.8281,330.5,248.8281,320.5,252.8281,324.5,248.8281" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="181.5" x2="326.5" y1="248.8281" y2="248.8281"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="188.5" y="243.895">TLS:</text><text fill="#0000FF" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="219.5" y="243.895">CLIENT HELLO</text><path d="M337,227.8281 L337,252.8281 L545,252.8281 L545,237.8281 L535,227.8281 L337,227.8281 " fill="#FBFB77" filter="url(#fywauudv5rfq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M535,227.8281 L535,237.8281 L545,237.8281 L535,227.8281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="343" y="244.895">Duplicate of data from Client.</text><path d="M35,266.9609 L35,291.9609 L323,291.9609 L323,276.9609 L313,266.9609 L35,266.9609 " fill="#FBFB77" filter="url(#fywauudv5rfq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M313,266.9609 L313,276.9609 L323,276.9609 L313,266.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="41" y="284.0278">Forward bytes between Client</text><path d="M236.25,276.2604 L233,279.544 L236.25,282.7604 L236.25,280.5938 L241.6667,280.5938 L241.6667,278.4271 L236.25,278.4271 L236.25,276.2604 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="246.6667" y="284.0278"/><path d="M253.0833,276.2604 L253.0833,278.4271 L247.6667,278.4271 L247.6667,280.5938 L253.0833,280.5938 L253.0833,282.7604 L256.3333,279.4768 L253.0833,276.2604 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="261.3333" y="284.0278">Service</text><polygon fill="#A80036" points="41.5,303.0938,31.5,307.0938,41.5,311.0938,37.5,307.0938" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="320.5,303.0938,330.5,307.0938,320.5,311.0938,324.5,307.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="35.5" x2="326.5" y1="307.0938" y2="307.0938"/><!--
@startuml
actor Client
participant "Ingress TS" as Ingress
participant Service

Client <-[#green]> Ingress : //TCP Connect//
Client -[#blue]-> Ingress : <font color="blue">TLS: ""CLIENT HELLO""</font>
note over Ingress : Map SNI to upstream Service
Ingress <-[#green]> Service : //TCP Connect//
Ingress -[#blue]-> Service : <font color="blue">TLS: ""CLIENT HELLO""</font>
note right : Duplicate of data from Client.
note over Ingress : Forward bytes between Client <&arrow-thick-left> <&arrow-thick-right> Service
Client <- -> Service

@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 GMT 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+11
Operating System: Linux
OS Version: 5.10.7-200.fc33.x86_64
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>