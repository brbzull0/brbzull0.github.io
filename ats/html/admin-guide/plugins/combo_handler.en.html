

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Combo Handler Plugin &#8212; Apache Traffic Server 10.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/override.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configuration Remap Plugin" href="conf_remap.en.html" />
    <link rel="prev" title="Cache Range Requests Plugin" href="cache_range_requests.en.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="combo-handler-plugin">
<span id="admin-plugins-combo-handler"></span><h1>Combo Handler Plugin<a class="headerlink" href="#combo-handler-plugin" title="Permalink to this headline">¶</a></h1>
<p>This plugin provides an intelligent way to combine multiple URLs into a single
URL, and have Apache Traffic Server combine the components into one
response. This is useful for example to create URLs that combine multiple CSS
or Javascript files into one.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This plugin is only built if the configure option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">experimental</span><span class="o">-</span><span class="n">plugins</span>
</pre></div>
</div>
<p>is given at build time. Note that this plugin is built and installed in
combination with the ESI module, since they share common code.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The arguments in the <a class="reference internal" href="../files/plugin.config.en.html#std-configfile-plugin.config"><code class="xref std std-file docutils literal notranslate"><span class="pre">plugin.config</span></code></a> line in order represent</p>
<ol class="arabic simple">
<li><p>The path that should triggers combo handler (defaults to
“admin/v1/combo”)</p></li>
<li><p>The name of the key used for signature verification (disabled by
default)</p></li>
<li><p>A colon separated list of headers which, if present on at least one response, will be
added to the combo response.</p></li>
<li><p>The path of a config file with allowed content types of objects to be combined, one per
line, without parameters. (Blank lines and comments starting with “#” are ignored.)
Parameters in the Content-Type field value will be ignored when
checking if they appear in the allowed types.  If the path does not start with “/”, the
config file must be located in the ATS config directory.  By default, all content types
are allowed, but if this file is specified, it must contain at least one content type.</p></li>
</ol>
<p>A “-” can be supplied as a value for any of these arguments to request
default value be applied.</p>
<p>Also, just like the original combohandler, this plugin generates URLs of
the form <code class="docutils literal notranslate"><span class="pre">http://localhost/&lt;dir&gt;/&lt;file-path&gt;</span></code>. <code class="docutils literal notranslate"><span class="pre">&lt;dir&gt;</span></code> here defaults
to <code class="docutils literal notranslate"><span class="pre">l</span></code> unless specified by the file path in the query parameter using
a colon. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://combo.com/admin/v1/combo?filepath1&amp;dir1:filepath2&amp;filepath3
</pre></div>
</div>
<p>Will result in these three pages being fetched:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">l</span><span class="o">/</span><span class="n">filepath1</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">dir1</span><span class="o">/</span><span class="n">filepath2</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">l</span><span class="o">/</span><span class="n">filepath3</span>
</pre></div>
</div>
<p>Remap rules have to be specified to map the above URLs to desired
content servers.</p>
<p>The plugin also supports a prefix parameter. Common parts of successive
file paths can be extracted and specified separately using a ‘p’ query
parameter. Successive file path parameters are appended to this prefix
to create complete file paths. The prefix will remain active until
changed or cleared (set to an empty string). For example, the query</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;/file1&amp;p=/path1/&amp;file2&amp;file3&amp;p=&amp;/file4&amp;p=/dir:path2/&amp;file5&amp;file6&quot;</span>
</pre></div>
</div>
<p>results in these file paths being “reconstructed”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">file1</span>
<span class="o">/</span><span class="n">path1</span><span class="o">/</span><span class="n">file2</span>
<span class="o">/</span><span class="n">path1</span><span class="o">/</span><span class="n">file3</span>
<span class="o">/</span><span class="n">file4</span>
<span class="o">/</span><span class="nb">dir</span><span class="p">:</span><span class="n">path2</span><span class="o">/</span><span class="n">file5</span>
<span class="o">/</span><span class="nb">dir</span><span class="p">:</span><span class="n">path2</span><span class="o">/</span><span class="n">file6</span>
</pre></div>
</div>
</div>
<div class="section" id="caching">
<h2>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h2>
<p>Combohandler follows a few rules for the “Cache-Control” header:</p>
<ol class="arabic simple">
<li><p>All requested documents must have “immutable” for the combo’d
response to also have “immutable”.</p></li>
<li><p>If one or more requested documents has “private” set, then the combo’d
response will also have “private”. If no requested documents have a
publicity setting, then the default is “public”.</p></li>
<li><p>The “max-age” value will be set to the smallest of all the requested “max-age”
values. If no documents has “max-age” set, then the default is 10 years.</p></li>
</ol>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/trans_logo_tm_380x69.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">Apache Traffic Server</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.en.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.en.html">Installing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.en.html">Proxy Cache Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interaction/index.en.html">Interacting with Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/index.en.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.en.html">Cache Storage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.en.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.en.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring/index.en.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuring-traffic-server.en.html">Configuring Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layer-4-routing.en.html">Layer 4 Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance/index.en.html">Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.en.html">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonrpc/index.en.html">JSONRPC API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.en.html#audience">Audience</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guide/index.en.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/index.en.html">Appendices</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.en.html">Administrator’s Guide</a><ul>
  <li><a href="index.en.html">Plugins</a><ul>
      <li>Previous: <a href="cache_range_requests.en.html" title="previous chapter">Cache Range Requests Plugin</a></li>
      <li>Next: <a href="conf_remap.en.html" title="next chapter">Configuration Remap Plugin</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>

    <div class="footer">
      &copy;2021, dev@trafficserver.apache.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/admin-guide/plugins/combo_handler.en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  </body>
</html>