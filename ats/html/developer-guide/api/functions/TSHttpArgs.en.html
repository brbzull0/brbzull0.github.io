

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TSHttpArgs &#8212; Apache Traffic Server 10.0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/override.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="TSHttpConnect" href="TSHttpConnect.en.html" />
    <link rel="prev" title="TSHostLookupResultAddrGet" href="TSHostLookupResultAddrGet.en.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tshttpargs">
<h1>TSHttpArgs<a class="headerlink" href="#tshttpargs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This set of API is obsoleted as of ATS v9.0.0, and will be removed with ATS v10.0.0!
For details of the new APIs, see <a class="reference internal" href="TSUserArgs.en.html#tsuserargs"><span class="std std-ref">TSUserArgs</span></a>.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ts/ts.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<dl class="c function">
<dt id="c.TSHttpTxnArgIndexReserve">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpTxnArgIndexReserve</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, <em class="property">const</em> char *<em>description</em>, int *<em>arg_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpTxnArgIndexReserve" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpTxnArgIndexNameLookup">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpTxnArgIndexNameLookup</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, int *<em>arg__idx</em>, <em class="property">const</em> char **<em>description</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpTxnArgIndexNameLookup" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpTxnArgIndexLookup">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpTxnArgIndexLookup</code><span class="sig-paren">(</span>int <em>arg_idx</em>, <em class="property">const</em> char **<em>name</em>, <em class="property">const</em> char **<em>description</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpTxnArgIndexLookup" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpSsnArgIndexReserve">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpSsnArgIndexReserve</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, <em class="property">const</em> char *<em>description</em>, int *<em>arg_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpSsnArgIndexReserve" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpSsnArgIndexNameLookup">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpSsnArgIndexNameLookup</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, int *<em>arg__idx</em>, <em class="property">const</em> char **<em>description</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpSsnArgIndexNameLookup" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpSsnArgIndexLookup">
<a class="reference internal" href="../types/TSReturnCode.en.html#c.TSReturnCode" title="TSReturnCode">TSReturnCode</a> <code class="sig-name descname">TSHttpSsnArgIndexLookup</code><span class="sig-paren">(</span>int <em>arg_idx</em>, <em class="property">const</em> char **<em>name</em>, <em class="property">const</em> char **<em>description</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpSsnArgIndexLookup" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpTxnArgSet">
void <code class="sig-name descname">TSHttpTxnArgSet</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSHttpTxn" title="TSHttpTxn">TSHttpTxn</a> <em>txnp</em>, int <em>arg_idx</em>, void *<em>arg</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpTxnArgSet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpTxnArgGet">
void *<code class="sig-name descname">TSHttpTxnArgGet</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSHttpTxn" title="TSHttpTxn">TSHttpTxn</a> <em>txnp</em>, int <em>arg_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpTxnArgGet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpSsnArgSet">
void <code class="sig-name descname">TSHttpSsnArgSet</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSHttpSsn" title="TSHttpSsn">TSHttpSsn</a> <em>ssnp</em>, int <em>arg_idx</em>, void *<em>arg</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpSsnArgSet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSHttpSsnArgGet">
void *<code class="sig-name descname">TSHttpSsnArgGet</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSHttpSsn" title="TSHttpSsn">TSHttpSsn</a> <em>ssnp</em>, int <em>arg_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSHttpSsnArgGet" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Traffic Server sessions and transactions provide a fixed array of void pointers that can be used by plugins to
store information. This can be used to avoid creating a per session or transaction continuations to
hold data, or to communicate between plugins as the values in the array are visible to any plugin
which can access the session or transaction. The array values are opaque to Traffic Server and it will not
dereference nor release them. Plugins are responsible for cleaning up any resources pointed to by the
values or, if the values are simply values, there is no need for the plugin to remove them after the
session or transaction has completed.</p>
<p>To avoid collisions between plugins a plugin should first <em>reserve</em> an index in the array. A
transaction based plugin argument is reserved by calling <a class="reference internal" href="#c.TSHttpTxnArgIndexReserve" title="TSHttpTxnArgIndexReserve"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpTxnArgIndexReserve()</span></code></a>. A session
base plugin argument is reserved by calling <a class="reference internal" href="#c.TSHttpSsnArgIndexReserve" title="TSHttpSsnArgIndexReserve"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpSsnArgIndexReserve()</span></code></a>. Both functions have the arguments</p>
<dl class="simple">
<dt><em>name</em></dt><dd><p>An identifying name for the plugin that reserved the index. Required.</p>
</dd>
<dt><em>description</em></dt><dd><p>An optional description of the use of the arg. This can be <code class="code docutils literal notranslate"><span class="pre">nullptr</span></code>.</p>
</dd>
<dt><em>arg_idx</em></dt><dd><p>A pointer to an <code class="code docutils literal notranslate"><span class="pre">int</span></code>. If an index is successfully reserved, the <code class="code docutils literal notranslate"><span class="pre">int</span></code> pointed at by this is
set to the reserved index. It is not modified if the call is unsuccessful.</p>
</dd>
</dl>
<p>The functions return <code class="code docutils literal notranslate"><span class="pre">TS_SUCCESS</span></code> if an index was reserved,
<code class="code docutils literal notranslate"><span class="pre">TS_ERROR</span></code> if not (most likely because all of the indices have already been reserved).
Generally this will be a file or library scope global which is set at plugin initialization. This
function is used in the example remap plugin <a class="reference external" href="https://github.com/apache/trafficserver/blob/master/example/plugins/c-api/remap/remap.cc">example/plugins/c-api/remap/remap.cc</a>. The index is stored
in the plugin global <code class="code docutils literal notranslate"><span class="pre">arg_index</span></code>. Transaction and session plugin argument indices are reserved
independently.</p>
<p>To look up the owner of a reserved index use <a class="reference internal" href="#c.TSHttpTxnArgIndexNameLookup" title="TSHttpTxnArgIndexNameLookup"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpTxnArgIndexNameLookup()</span></code></a> or
<a class="reference internal" href="#c.TSHttpSsnArgIndexNameLookup" title="TSHttpSsnArgIndexNameLookup"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpSsnArgIndexNameLookup()</span></code></a> for transaction and session plugin argument respectively. If
<em>name</em> is found as an owner, the function returns <code class="code docutils literal notranslate"><span class="pre">TS_SUCCESS</span></code> and <em>arg_index</em> is
updated with the index reserved under that name. If <em>description</em> is not <code class="code docutils literal notranslate"><span class="pre">NULL</span></code> then
the character pointer to which it points will be updated to point at the description for that
reserved index. This enables communication between plugins where plugin “A” reserves an index under
a well known name and plugin “B” locates the index by looking it up under that name.</p>
<p>The owner of a reserved index can be found with <a class="reference internal" href="#c.TSHttpTxnArgIndexLookup" title="TSHttpTxnArgIndexLookup"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpTxnArgIndexLookup()</span></code></a> or
<a class="reference internal" href="#c.TSHttpSsnArgIndexLookup" title="TSHttpSsnArgIndexLookup"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpSsnArgIndexLookup()</span></code></a> for transaction and session plugin arguments respectively. If
<em>arg_index</em> is reserved then the function returns <code class="code docutils literal notranslate"><span class="pre">TS_SUCCESS</span></code> and the pointers referred
to by <em>name</em> and <em>description</em> are updated. <em>name</em> must point at a valid character
pointer but <em>description</em> can be <code class="code docutils literal notranslate"><span class="pre">NULL</span></code> in which case it is ignored.</p>
<p>Manipulating the array is simple. <a class="reference internal" href="#c.TSHttpTxnArgSet" title="TSHttpTxnArgSet"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpTxnArgSet()</span></code></a> sets the array slot at <em>arg_idx</em> for
the transaction <em>txnp</em> to the value <em>arg</em>. Note this sets the value only for the specific
transaction. Similarly <a class="reference internal" href="#c.TSHttpSsnArgSet" title="TSHttpSsnArgSet"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpSsnArgSet()</span></code></a> sets the value for a session argument. The values can
be retrieved with <a class="reference internal" href="#c.TSHttpTxnArgGet" title="TSHttpTxnArgGet"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpTxnArgGet()</span></code></a> for transactions and <a class="reference internal" href="#c.TSHttpSsnArgGet" title="TSHttpSsnArgGet"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSHttpSsnArgGet()</span></code></a> for sessions,
which return the specified value. Values that have not been set are <code class="code docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Session arguments persist for the entire session, which means potentially across all transactions in that session.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Following arg index reservations is conventional, it is not enforced.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/trans_logo_tm_380x69.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../index.html">Apache Traffic Server</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.en.html">Administrator’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.en.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release-process/index.en.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/index.en.html">Contributing to Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-with-vagrant/index.en.html">Using Vagrant to Test Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debugging/index.en.html">Debugging and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../threads-and-events.en.html">Threads and Event Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cache-architecture/index.en.html">Cache Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging-architecture/index.en.html">Logging Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal-libraries/index.en.html">Internal libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.en.html">Plugin Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config-vars.en.html">Configuration Variable Implementation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.en.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../continuous-integration/index.en.html">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/index.en.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../host-resolution-proposal.en.html">Host Resolution Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../client-session-architecture.en.html">An Overview Client Sessions and Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core-architecture/index.en.html">Core Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design-documents/index.en.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/index.en.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing/index.en.html">Testing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonrpc/index.en.html">JSONRPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/index.en.html">Appendices</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.en.html">Developer’s Guide</a><ul>
  <li><a href="../index.en.html">API Reference</a><ul>
  <li><a href="index.en.html">API Functions</a><ul>
      <li>Previous: <a href="TSHostLookupResultAddrGet.en.html" title="previous chapter">TSHostLookupResultAddrGet</a></li>
      <li>Next: <a href="TSHttpConnect.en.html" title="next chapter">TSHttpConnect</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>

    <div class="footer">
      &copy;2021, dev@trafficserver.apache.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/developer-guide/api/functions/TSHttpArgs.en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  </body>
</html>