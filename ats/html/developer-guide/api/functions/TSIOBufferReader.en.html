

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TSIOBufferReader &#8212; Apache Traffic Server 10.0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/override.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="TSInstallDirGet" href="TSInstallDirGet.en.html" />
    <link rel="prev" title="TSIOBufferCreate" href="TSIOBufferCreate.en.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tsiobufferreader">
<h1>TSIOBufferReader<a class="headerlink" href="#tsiobufferreader" title="Permalink to this headline">¶</a></h1>
<p>Traffic Server IO buffer reader API.</p>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ts/ts.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<dl class="c function">
<dt id="c.TSIOBufferReaderAlloc">
<a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <code class="sig-name descname">TSIOBufferReaderAlloc</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBuffer" title="TSIOBuffer">TSIOBuffer</a> <em>bufp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderAlloc" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderClone">
<a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <code class="sig-name descname">TSIOBufferReaderClone</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>readerp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderClone" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderFree">
void <code class="sig-name descname">TSIOBufferReaderFree</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>readerp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderFree" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderConsume">
void <code class="sig-name descname">TSIOBufferReaderConsume</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>readerp</em>, int64_t <em>nbytes</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderConsume" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderStart">
<a class="reference internal" href="TSTypes.en.html#c.TSIOBufferBlock" title="TSIOBufferBlock">TSIOBufferBlock</a> <code class="sig-name descname">TSIOBufferReaderStart</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>readerp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderStart" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderAvail">
int64_t <code class="sig-name descname">TSIOBufferReaderAvail</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>readerp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderAvail" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt id="c.TSIOBufferReaderCopy">
int64_t <code class="sig-name descname">TSIOBufferReaderCopy</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader">TSIOBufferReader</a> <em>reader</em>, void *<em>buf</em>, int64_t <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSIOBufferReaderCopy" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="TSTypes.en.html#c.TSIOBufferReader" title="TSIOBufferReader"><code class="xref c c-type docutils literal notranslate"><span class="pre">TSIOBufferReader</span></code></a> is an read accessor for <a class="reference internal" href="TSTypes.en.html#c.TSIOBuffer" title="TSIOBuffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">TSIOBuffer</span></code></a>. It represents a location in
the contents of the buffer. A buffer can have multiple readers and each reader consumes data in the
buffer independently. Data which for which there are no readers is discarded from the buffer. This
has two very important consequences –</p>
<ul class="simple">
<li><p>Data for which there are no readers and no writer will be discarded. In effect this means without
any readers only the current write buffer block will be maintained, older buffer blocks will
disappear.</p></li>
<li><p>Conversely keeping a reader around unused will pin the buffer data in memory. This can be useful
or harmful.</p></li>
</ul>
<p>A buffer has a fixed amount of possible readers (currently 5) which is determined at compile
time. Reader allocation is fast and cheap until this maximum is reached at which point it fails.</p>
<dl>
<dt><a class="reference internal" href="#c.TSIOBufferReaderAlloc" title="TSIOBufferReaderAlloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderAlloc()</span></code></a> allocate a reader.</dt><dd><p>A reader for the IO buffer <em>bufp</em> is created and returned. This should only be called on a
newly allocated buffer. If not the location of the reader in the buffer will be indeterminate.
Use <a class="reference internal" href="#c.TSIOBufferReaderClone" title="TSIOBufferReaderClone"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderClone()</span></code></a> to get another reader if the buffer is already in use.</p>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderClone" title="TSIOBufferReaderClone"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderClone()</span></code></a> duplicate a reader.</dt><dd><p>A reader for <em>bufp</em> is allocated and the initial reader position is set to be the same as
<em>reader</em>.</p>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderFree" title="TSIOBufferReaderFree"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderFree()</span></code></a> de-allocate <em>reader</em>.</dt><dd><p>This also effectively consumes (see <a class="reference internal" href="#c.TSIOBufferReaderConsume" title="TSIOBufferReaderConsume"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderConsume()</span></code></a>) all data for <em>reader</em>.</p>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderConsume" title="TSIOBufferReaderConsume"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderConsume()</span></code></a> consume data from <em>reader</em>.</dt><dd><p>This advances the position of <em>reader</em> in its IO buffer by the smaller of <em>nbytes</em>
and the maximum available in the buffer. This is required to release the buffer memory - when
data has been consumed by all readers, it is discarded.</p>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderStart" title="TSIOBufferReaderStart"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderStart()</span></code></a> Get the first buffer block.</dt><dd><p>This returns the <a class="reference internal" href="TSTypes.en.html#c.TSIOBufferBlock" title="TSIOBufferBlock"><code class="xref c c-type docutils literal notranslate"><span class="pre">TSIOBufferBlock</span></code></a> which contains the first byte available to <em>reader</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The byte at the position of <em>reader</em> is in the block but is not necessarily the first byte of the block.</p>
</div>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderAvail" title="TSIOBufferReaderAvail"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderAvail()</span></code></a> returns the number of bytes available.</dt><dd><p>The bytes available is the amount of data that could be read from <em>reader</em>.</p>
</dd>
<dt><a class="reference internal" href="#c.TSIOBufferReaderCopy" title="TSIOBufferReaderCopy"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSIOBufferReaderCopy()</span></code></a> copies data from <em>reader</em> into <em>buff</em>.</dt><dd><p>This copies data from the IO buffer for <em>reader</em> to the target buffer <em>bufp</em>. The
amount of data read in this fashion is the smaller of the amount of data available in the IO
buffer for <em>reader</em> and the size of the target buffer (<em>length</em>). The number of bytes
copied is returned.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Destroying a <a class="reference internal" href="TSTypes.en.html#c.TSIOBuffer" title="TSIOBuffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">TSIOBuffer</span></code></a> will de-allocate and destroy all readers for that buffer.</p>
</div>
</div>
<div class="section" id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p><em class="manpage">TSIOBufferCreate(3ts)</em></p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/trans_logo_tm_380x69.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../index.html">Apache Traffic Server</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.en.html">Administrator’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.en.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release-process/index.en.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/index.en.html">Contributing to Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-with-vagrant/index.en.html">Using Vagrant to Test Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debugging/index.en.html">Debugging and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../threads-and-events.en.html">Threads and Event Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cache-architecture/index.en.html">Cache Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging-architecture/index.en.html">Logging Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal-libraries/index.en.html">Internal libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.en.html">Plugin Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config-vars.en.html">Configuration Variable Implementation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.en.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../continuous-integration/index.en.html">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/index.en.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../host-resolution-proposal.en.html">Host Resolution Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../client-session-architecture.en.html">An Overview Client Sessions and Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core-architecture/index.en.html">Core Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design-documents/index.en.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/index.en.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing/index.en.html">Testing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonrpc/index.en.html">JSONRPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/index.en.html">Appendices</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.en.html">Developer’s Guide</a><ul>
  <li><a href="../index.en.html">API Reference</a><ul>
  <li><a href="index.en.html">API Functions</a><ul>
      <li>Previous: <a href="TSIOBufferCreate.en.html" title="previous chapter">TSIOBufferCreate</a></li>
      <li>Next: <a href="TSInstallDirGet.en.html" title="next chapter">TSInstallDirGet</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>

    <div class="footer">
      &copy;2021, dev@trafficserver.apache.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/developer-guide/api/functions/TSIOBufferReader.en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  </body>
</html>