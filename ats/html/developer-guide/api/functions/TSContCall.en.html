

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TSContCall &#8212; Apache Traffic Server 10.0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/override.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="TSContCreate" href="TSContCreate.en.html" />
    <link rel="prev" title="TSConfig Functions" href="TSConfig.en.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tscontcall">
<h1>TSContCall<a class="headerlink" href="#tscontcall" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ts/ts.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<dl class="c function">
<dt id="c.TSContCall">
int <code class="sig-name descname">TSContCall</code><span class="sig-paren">(</span><a class="reference internal" href="TSTypes.en.html#c.TSCont" title="TSCont">TSCont</a> <em>contp</em>, <a class="reference internal" href="../types/TSEvent.en.html#c.TSEvent" title="TSEvent">TSEvent</a> <em>event</em>, void *<em>edata</em><span class="sig-paren">)</span><a class="headerlink" href="#c.TSContCall" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Call the continuation <em>contp</em> as if from a hook with the event type <em>event</em> and data of
<em>edata</em>. Presuming <em>contp</em> was created in a manner like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TSContCreate</span><span class="p">(</span><span class="n">CallbackHandler</span><span class="p">,</span> <span class="n">TSMutexCreate</span><span class="p">());</span>
</pre></div>
</div>
<p>Therefore there is a function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">CallbackHandler</span><span class="p">(</span><span class="n">TSCont</span> <span class="n">this</span><span class="p">,</span> <span class="n">TSEvent</span> <span class="nb">id</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span> <span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
<p>As a result <a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a> will effectively do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">CallbackHandler</span><span class="p">(</span><span class="n">contp</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">edata</span><span class="p">);</span>
</pre></div>
</div>
<p>If there is a mutex associated with <em>contp</em>, <a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a> assumes that mutex is held already.
<a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a> will directly call the handler associated with the continuation.  It will return the
value returned by the handler in <em>contp</em>.</p>
<p>If <em>contp</em> has a mutex, the plugin must acquire the lock on the mutex for <em>contp</em> before calling
<a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a>. See <a class="reference internal" href="TSContMutexGet.en.html#c.TSContMutexGet" title="TSContMutexGet"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContMutexGet()</span></code></a> and <a class="reference internal" href="TSMutexLockTry.en.html#c.TSMutexLockTry" title="TSMutexLockTry"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSMutexLockTry()</span></code></a> for mechanisms for doing this.</p>
<p>The most common case is the code called by <a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a> must complete before further code is executed
at the call site. An alternative approach to handling the locking directly would be to split the call site
into two continuations, one of which is signalled (possibly via <a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a>) from the original
<a class="reference internal" href="#c.TSContCall" title="TSContCall"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSContCall()</span></code></a> target.</p>
<p>Note mutexes returned by <a class="reference internal" href="TSMutexCreate.en.html#c.TSMutexCreate" title="TSMutexCreate"><code class="xref c c-func docutils literal notranslate"><span class="pre">TSMutexCreate()</span></code></a> are recursive mutexes, therefore if the lock is
already held on the thread of execution acquiring the lock again is very fast. Mutexes are also
shareable so that the same mutex can be used for multiple continuations.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TSMutex</span> <span class="n">mutex</span> <span class="o">=</span> <span class="n">TSMutexCreate</span><span class="p">();</span>
<span class="n">TSCont</span> <span class="n">cont1</span> <span class="o">=</span> <span class="n">TSContCreate</span><span class="p">(</span><span class="n">Handler1</span><span class="p">,</span> <span class="n">mutex</span><span class="p">);</span>
<span class="n">TSCont</span> <span class="n">cont2</span> <span class="o">=</span> <span class="n">TSContCreate</span><span class="p">(</span><span class="n">Handler2</span><span class="p">,</span> <span class="n">mutex</span><span class="p">);</span>
</pre></div>
</div>
<p>In this example case, <code class="code docutils literal notranslate"><span class="pre">cont1</span></code> can assume the lock for <code class="code docutils literal notranslate"><span class="pre">cont2</span></code> is held. This should be
considered carefully because for the same reason any thread protection between the continuations is
removed. This works well for tightly coupled continuations that always operate in a fixed sequence.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/trans_logo_tm_380x69.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../index.html">Apache Traffic Server</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../preface/index.en.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.en.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/index.en.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.en.html">Administrator’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.en.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.en.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release-process/index.en.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/index.en.html">Contributing to Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-with-vagrant/index.en.html">Using Vagrant to Test Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debugging/index.en.html">Debugging and Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../threads-and-events.en.html">Threads and Event Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cache-architecture/index.en.html">Cache Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging-architecture/index.en.html">Logging Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal-libraries/index.en.html">Internal libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins/index.en.html">Plugin Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config-vars.en.html">Configuration Variable Implementation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.en.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../continuous-integration/index.en.html">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/index.en.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../host-resolution-proposal.en.html">Host Resolution Proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../client-session-architecture.en.html">An Overview Client Sessions and Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core-architecture/index.en.html">Core Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design-documents/index.en.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/index.en.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing/index.en.html">Testing Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonrpc/index.en.html">JSONRPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/index.en.html">Appendices</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.en.html">Developer’s Guide</a><ul>
  <li><a href="../index.en.html">API Reference</a><ul>
  <li><a href="index.en.html">API Functions</a><ul>
      <li>Previous: <a href="TSConfig.en.html" title="previous chapter">TSConfig Functions</a></li>
      <li>Next: <a href="TSContCreate.en.html" title="next chapter">TSContCreate</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Apache Traffic Server</span>
    v: 10.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl id="lang-list">
      <dt>Languages</dt>
    </dl>
    <dl id="version-list">
      <dt>Versions</dt>
    </dl>
  </div>
</div>
<script>
$(function() {
  function update_langlist (json) {
    for (var lang in json) {
      $('#lang-list').append('<dd><a href="/' + lang + '/latest/">' + json[lang]['name'] + '</a></dd>');
    }
    for (var i in json[curlang]['versions']) {
      var ver = json[curlang]['versions'][i];
      $('#version-list').append('<dd><a href="/' + curlang + '/' + ver + '/">' + ver + '</a></dd>');
    }
  }
  var curlang = "None" == "None" ? "en" : "None";
  $.ajax({
    'url':      "/en/latest/_static/languages.json",
    'dataType': "json",
    'success':  function (json) { update_langlist(json) },
    'error':    function (xhr,errstr,e) {
      $.ajax({
        'url':      "/_static/languages.json",
        'dataType': "json",
        'success':  function (json) { update_langlist(json) }
      })
    }
  });
});
</script>

    <div class="footer">
      &copy;2021, dev@trafficserver.apache.org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/developer-guide/api/functions/TSContCall.en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  </body>
</html>